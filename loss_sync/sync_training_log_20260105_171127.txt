/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.
  warnings.warn(f"Warning: The {path} owner does not match the current owner.")
/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.
  warnings.warn(f"Warning: The {path} owner does not match the current owner.")
/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.
  warnings.warn(f"Warning: The {path} owner does not match the current owner.")
/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.
  warnings.warn(f"Warning: The {path} owner does not match the current owner.")
/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[Rank 0 | Local Rank 0] 2026-01-05 17:11:44,489 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...
/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/ray/_private/node.py:1125: ResourceWarning: unclosed file <_io.TextIOWrapper name='/dev/null' mode='w' encoding='UTF-8'>
  process_info = ray._private.services.start_gcs_server(
/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/ray/_private/node.py:1086: ResourceWarning: unclosed file <_io.TextIOWrapper name='/dev/null' mode='w' encoding='UTF-8'>
  self._webui_url, process_info = ray._private.services.start_api_server(
2026-01-05 17:11:53,645	WARNING utils.py:460 -- Detecting docker specified CPUs. In previous versions of Ray, CPU detection in containers was incorrect. Please ensure that Ray has enough CPUs allocated. As a temporary workaround to revert to the prior behavior, set `RAY_USE_MULTIPROCESSING_CPU_COUNT=1` as an env var before starting Ray. Set the env var: `RAY_DISABLE_DOCKER_CPU_WARNING=1` to mute this warning.
2026-01-05 17:11:54,979	INFO worker.py:2003 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
/home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/ray/_private/worker.py:2051: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(pid=34683)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.
[36m(pid=34683)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=34683)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.
[36m(pid=34683)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=34683)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.
[36m(pid=34683)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=34683)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.
[36m(pid=34683)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=34683)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
[36m(pid=34683)[0m     *************************************************************************************************************
[36m(pid=34683)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
[36m(pid=34683)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
[36m(pid=34683)[0m     The backend in torch.distributed.init_process_group set to hccl now..
[36m(pid=34683)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
[36m(pid=34683)[0m     The device parameters have been replaced with npu in the function below:
[36m(pid=34683)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
[36m(pid=34683)[0m     *************************************************************************************************************
[36m(pid=34683)[0m     
[36m(pid=34683)[0m   warnings.warn(msg, ImportWarning)
[36m(pid=34683)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
[36m(pid=34683)[0m   warnings.warn(msg, RuntimeWarning)
[36m(pid=34683)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...
[36m(pid=34683)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=34683)[0m   import pkg_resources
ray init kwargs: {'num_cpus': None, 'runtime_env': {'env_vars': {'TOKENIZERS_PARALLELISM': 'true', 'NCCL_DEBUG': 'WARN', 'VLLM_LOGGING_LEVEL': 'WARN', 'VLLM_ALLOW_RUNTIME_LORA_UPDATING': 'true', 'VLLM_ALLREDUCE_USE_SYMM_MEM': '0', 'CUDA_DEVICE_MAX_CONNECTIONS': '1', 'NCCL_CUMEM_ENABLE': '0'}, 'working_dir': None}}
[36m(pid=34683)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:12:15,404 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
[36m(TaskRunner pid=34683)[0m TaskRunner hostname: notebook-7f74bd20-3c19-4e51-b968-a157f487844c, PID: 34683
[36m(TaskRunner pid=34683)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=34683)[0m                                  'calculate_entropy': False,
[36m(TaskRunner pid=34683)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=34683)[0m                                                 'async_save': False,
[36m(TaskRunner pid=34683)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=34683)[0m                                                                   'optimizer',
[36m(TaskRunner pid=34683)[0m                                                                   'extra'],
[36m(TaskRunner pid=34683)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=34683)[0m                                                                   'optimizer',
[36m(TaskRunner pid=34683)[0m                                                                   'extra']},
[36m(TaskRunner pid=34683)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=34683)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=34683)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=34683)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=34683)[0m                                  'data_loader_seed': 42,
[36m(TaskRunner pid=34683)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=34683)[0m                                  'entropy_coeff': 0.001,
[36m(TaskRunner pid=34683)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=34683)[0m                                  'freeze_vision_tower': False,
[36m(TaskRunner pid=34683)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=34683)[0m                                                  'dtype': 'bfloat16',
[36m(TaskRunner pid=34683)[0m                                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=34683)[0m                                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=34683)[0m                                                  'forward_only': False,
[36m(TaskRunner pid=34683)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=34683)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=34683)[0m                                                  'full_determinism': False,
[36m(TaskRunner pid=34683)[0m                                                  'model_dtype': 'fp32',
[36m(TaskRunner pid=34683)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=34683)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=34683)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=34683)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=34683)[0m                                                  'seed': 42,
[36m(TaskRunner pid=34683)[0m                                                  'strategy': 'fsdp',
[36m(TaskRunner pid=34683)[0m                                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                                                  'use_orig_params': False,
[36m(TaskRunner pid=34683)[0m                                                  'use_torch_compile': True,
[36m(TaskRunner pid=34683)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=34683)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=34683)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=34683)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=34683)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=34683)[0m                                  'loss_scale_factor': None,
[36m(TaskRunner pid=34683)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=34683)[0m                                            'betas': [0.9, 0.999],
[36m(TaskRunner pid=34683)[0m                                            'clip_grad': 1.0,
[36m(TaskRunner pid=34683)[0m                                            'lr': 5e-07,
[36m(TaskRunner pid=34683)[0m                                            'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=34683)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=34683)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=34683)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=34683)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=34683)[0m                                            'optimizer': 'AdamW',
[36m(TaskRunner pid=34683)[0m                                            'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=34683)[0m                                            'override_optimizer_config': None,
[36m(TaskRunner pid=34683)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=34683)[0m                                            'warmup_style': None,
[36m(TaskRunner pid=34683)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=34683)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=34683)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=34683)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=34683)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=34683)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=34683)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=34683)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=34683)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=34683)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=34683)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=34683)[0m                                  'ppo_micro_batch_size_per_gpu': 2,
[36m(TaskRunner pid=34683)[0m                                  'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=34683)[0m                                  'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=34683)[0m                                               'all_ranks': False,
[36m(TaskRunner pid=34683)[0m                                               'enable': False,
[36m(TaskRunner pid=34683)[0m                                               'ranks': [],
[36m(TaskRunner pid=34683)[0m                                               'save_path': 'outputs/profile',
[36m(TaskRunner pid=34683)[0m                                               'tool': None,
[36m(TaskRunner pid=34683)[0m                                               'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                       'analysis': True,
[36m(TaskRunner pid=34683)[0m                                                                       'contents': [],
[36m(TaskRunner pid=34683)[0m                                                                       'discrete': False,
[36m(TaskRunner pid=34683)[0m                                                                       'level': 'level0'},
[36m(TaskRunner pid=34683)[0m                                                               'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                        'discrete': False},
[36m(TaskRunner pid=34683)[0m                                                               'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                         'step_end': None,
[36m(TaskRunner pid=34683)[0m                                                                         'step_start': 0},
[36m(TaskRunner pid=34683)[0m                                                               'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                                'stack_depth': 32,
[36m(TaskRunner pid=34683)[0m                                                                                'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=34683)[0m                                  'rollout_n': 8,
[36m(TaskRunner pid=34683)[0m                                  'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=34683)[0m                                                    'mode': 'disabled',
[36m(TaskRunner pid=34683)[0m                                                    'record_file': None,
[36m(TaskRunner pid=34683)[0m                                                    'replay_file': None},
[36m(TaskRunner pid=34683)[0m                                  'shuffle': False,
[36m(TaskRunner pid=34683)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=34683)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=34683)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=34683)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=34683)[0m                                  'use_remove_padding': False,
[36m(TaskRunner pid=34683)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=34683)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=34683)[0m                        'model': {'_target_': 'verl.workers.config.HFModelConfig',
[36m(TaskRunner pid=34683)[0m                                  'custom_chat_template': None,
[36m(TaskRunner pid=34683)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=34683)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=34683)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=34683)[0m                                  'external_lib': None,
[36m(TaskRunner pid=34683)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=34683)[0m                                  'hf_config_path': None,
[36m(TaskRunner pid=34683)[0m                                  'lora_adapter_path': None,
[36m(TaskRunner pid=34683)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=34683)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=34683)[0m                                  'override_config': {},
[36m(TaskRunner pid=34683)[0m                                  'path': '/home/ma-user/work/models/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=34683)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=34683)[0m                                  'tokenizer_path': None,
[36m(TaskRunner pid=34683)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=34683)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=34683)[0m                                  'use_liger': False,
[36m(TaskRunner pid=34683)[0m                                  'use_remove_padding': False,
[36m(TaskRunner pid=34683)[0m                                  'use_shm': False},
[36m(TaskRunner pid=34683)[0m                        'nccl_timeout': 600,
[36m(TaskRunner pid=34683)[0m                        'ref': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=34683)[0m                                'entropy_checkpointing': False,
[36m(TaskRunner pid=34683)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=34683)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=34683)[0m                                                'dtype': 'bfloat16',
[36m(TaskRunner pid=34683)[0m                                                'entropy_checkpointing': False,
[36m(TaskRunner pid=34683)[0m                                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=34683)[0m                                                'forward_only': True,
[36m(TaskRunner pid=34683)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=34683)[0m                                                'fsdp_size': -1,
[36m(TaskRunner pid=34683)[0m                                                'full_determinism': False,
[36m(TaskRunner pid=34683)[0m                                                'model_dtype': 'fp32',
[36m(TaskRunner pid=34683)[0m                                                'offload_policy': False,
[36m(TaskRunner pid=34683)[0m                                                'optimizer_offload': False,
[36m(TaskRunner pid=34683)[0m                                                'param_offload': False,
[36m(TaskRunner pid=34683)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=34683)[0m                                                'seed': 42,
[36m(TaskRunner pid=34683)[0m                                                'strategy': 'fsdp',
[36m(TaskRunner pid=34683)[0m                                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                                                'use_orig_params': False,
[36m(TaskRunner pid=34683)[0m                                                'use_torch_compile': True,
[36m(TaskRunner pid=34683)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=34683)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=34683)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=34683)[0m                                'log_prob_micro_batch_size_per_gpu': 2,
[36m(TaskRunner pid=34683)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=34683)[0m                                'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=34683)[0m                                             'all_ranks': False,
[36m(TaskRunner pid=34683)[0m                                             'enable': False,
[36m(TaskRunner pid=34683)[0m                                             'ranks': [],
[36m(TaskRunner pid=34683)[0m                                             'save_path': 'outputs/profile',
[36m(TaskRunner pid=34683)[0m                                             'tool': None,
[36m(TaskRunner pid=34683)[0m                                             'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                     'analysis': True,
[36m(TaskRunner pid=34683)[0m                                                                     'contents': [],
[36m(TaskRunner pid=34683)[0m                                                                     'discrete': False,
[36m(TaskRunner pid=34683)[0m                                                                     'level': 'level0'},
[36m(TaskRunner pid=34683)[0m                                                             'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                      'discrete': False},
[36m(TaskRunner pid=34683)[0m                                                             'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                       'step_end': None,
[36m(TaskRunner pid=34683)[0m                                                                       'step_start': 0},
[36m(TaskRunner pid=34683)[0m                                                             'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                              'stack_depth': 32,
[36m(TaskRunner pid=34683)[0m                                                                              'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=34683)[0m                                'rollout_n': 8,
[36m(TaskRunner pid=34683)[0m                                'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=34683)[0m                                                  'mode': 'disabled',
[36m(TaskRunner pid=34683)[0m                                                  'record_file': None,
[36m(TaskRunner pid=34683)[0m                                                  'replay_file': None},
[36m(TaskRunner pid=34683)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=34683)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=34683)[0m                        'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=34683)[0m                                    'agent': {'_target_': 'verl.workers.config.AgentLoopConfig',
[36m(TaskRunner pid=34683)[0m                                              'agent_loop_config_path': None,
[36m(TaskRunner pid=34683)[0m                                              'custom_async_server': {'_target_': 'verl.workers.config.CustomAsyncServerConfig',
[36m(TaskRunner pid=34683)[0m                                                                      'name': None,
[36m(TaskRunner pid=34683)[0m                                                                      'path': None},
[36m(TaskRunner pid=34683)[0m                                              'default_agent_loop': 'single_turn_agent',
[36m(TaskRunner pid=34683)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=34683)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=34683)[0m                                    'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=34683)[0m                                    'data_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=34683)[0m                                    'do_sample': True,
[36m(TaskRunner pid=34683)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=34683)[0m                                    'enable_chunked_prefill': False,
[36m(TaskRunner pid=34683)[0m                                    'enable_prefix_caching': True,
[36m(TaskRunner pid=34683)[0m                                    'enable_rollout_routing_replay': False,
[36m(TaskRunner pid=34683)[0m                                    'enforce_eager': False,
[36m(TaskRunner pid=34683)[0m                                    'engine_kwargs': {'sglang': {}, 'vllm': {}},
[36m(TaskRunner pid=34683)[0m                                    'expert_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=34683)[0m                                    'gpu_memory_utilization': 0.7,
[36m(TaskRunner pid=34683)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=34683)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=34683)[0m                                    'load_format': 'dummy',
[36m(TaskRunner pid=34683)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=34683)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=34683)[0m                                    'log_prob_micro_batch_size_per_gpu': 2,
[36m(TaskRunner pid=34683)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=34683)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=34683)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=34683)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=34683)[0m                                    'mode': 'async',
[36m(TaskRunner pid=34683)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=34683)[0m                                    'multi_turn': {'_target_': 'verl.workers.config.MultiTurnConfig',
[36m(TaskRunner pid=34683)[0m                                                   'enable': False,
[36m(TaskRunner pid=34683)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=34683)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=34683)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=34683)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=34683)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=34683)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=34683)[0m                                                   'num_repeat_rollouts': None,
[36m(TaskRunner pid=34683)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=34683)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=34683)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=34683)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=34683)[0m                                    'n': 8,
[36m(TaskRunner pid=34683)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=34683)[0m                                    'over_sample_rate': 0,
[36m(TaskRunner pid=34683)[0m                                    'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                                    'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=34683)[0m                                                 'all_ranks': False,
[36m(TaskRunner pid=34683)[0m                                                 'enable': False,
[36m(TaskRunner pid=34683)[0m                                                 'ranks': [],
[36m(TaskRunner pid=34683)[0m                                                 'save_path': 'outputs/profile',
[36m(TaskRunner pid=34683)[0m                                                 'tool': None,
[36m(TaskRunner pid=34683)[0m                                                 'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                         'analysis': True,
[36m(TaskRunner pid=34683)[0m                                                                         'contents': [],
[36m(TaskRunner pid=34683)[0m                                                                         'discrete': False,
[36m(TaskRunner pid=34683)[0m                                                                         'level': 'level0'},
[36m(TaskRunner pid=34683)[0m                                                                 'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                          'discrete': False},
[36m(TaskRunner pid=34683)[0m                                                                 'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                           'step_end': None,
[36m(TaskRunner pid=34683)[0m                                                                           'step_start': 0},
[36m(TaskRunner pid=34683)[0m                                                                 'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                                  'stack_depth': 32,
[36m(TaskRunner pid=34683)[0m                                                                                  'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=34683)[0m                                    'prometheus': {'_target_': 'verl.workers.config.PrometheusConfig',
[36m(TaskRunner pid=34683)[0m                                                   'enable': False,
[36m(TaskRunner pid=34683)[0m                                                   'file': '/tmp/ray/session_latest/metrics/prometheus/prometheus.yml',
[36m(TaskRunner pid=34683)[0m                                                   'port': 9090,
[36m(TaskRunner pid=34683)[0m                                                   'served_model_name': '/home/ma-user/work/models/Qwen2.5-0.5B-Instruct'},
[36m(TaskRunner pid=34683)[0m                                    'prompt_length': 2048,
[36m(TaskRunner pid=34683)[0m                                    'quantization': None,
[36m(TaskRunner pid=34683)[0m                                    'quantization_config_file': None,
[36m(TaskRunner pid=34683)[0m                                    'response_length': 3072,
[36m(TaskRunner pid=34683)[0m                                    'skip_dump_dir': '/tmp/rollout_dump',
[36m(TaskRunner pid=34683)[0m                                    'skip_rollout': False,
[36m(TaskRunner pid=34683)[0m                                    'skip_tokenizer_init': True,
[36m(TaskRunner pid=34683)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=34683)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=34683)[0m                                    'top_k': -1,
[36m(TaskRunner pid=34683)[0m                                    'top_p': 1,
[36m(TaskRunner pid=34683)[0m                                    'trace': {'_target_': 'verl.workers.config.TraceConfig',
[36m(TaskRunner pid=34683)[0m                                              'backend': None,
[36m(TaskRunner pid=34683)[0m                                              'max_samples_per_step_per_worker': None,
[36m(TaskRunner pid=34683)[0m                                              'token2text': False},
[36m(TaskRunner pid=34683)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=34683)[0m                                    'val_kwargs': {'_target_': 'verl.workers.config.SamplingConfig',
[36m(TaskRunner pid=34683)[0m                                                   'do_sample': False,
[36m(TaskRunner pid=34683)[0m                                                   'n': 1,
[36m(TaskRunner pid=34683)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=34683)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=34683)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=34683)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=34683)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=34683)[0m                'gamma': 1.0,
[36m(TaskRunner pid=34683)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=34683)[0m                            'horizon': 10000,
[36m(TaskRunner pid=34683)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=34683)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=34683)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=34683)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=34683)[0m                'lam': 1.0,
[36m(TaskRunner pid=34683)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=34683)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=34683)[0m                'rollout_correction': {'bypass_mode': False,
[36m(TaskRunner pid=34683)[0m                                       'loss_type': 'ppo_clip',
[36m(TaskRunner pid=34683)[0m                                       'rollout_is': None,
[36m(TaskRunner pid=34683)[0m                                       'rollout_is_batch_normalize': False,
[36m(TaskRunner pid=34683)[0m                                       'rollout_is_threshold': 2.0,
[36m(TaskRunner pid=34683)[0m                                       'rollout_rs': None,
[36m(TaskRunner pid=34683)[0m                                       'rollout_rs_threshold': None,
[36m(TaskRunner pid=34683)[0m                                       'rollout_rs_threshold_lower': None,
[36m(TaskRunner pid=34683)[0m                                       'rollout_token_veto_threshold': None},
[36m(TaskRunner pid=34683)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=34683)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=34683)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=34683)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=34683)[0m                            'async_save': False,
[36m(TaskRunner pid=34683)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=34683)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=34683)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=34683)[0m             'data_loader_seed': 42,
[36m(TaskRunner pid=34683)[0m             'enable': None,
[36m(TaskRunner pid=34683)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=34683)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=34683)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=34683)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=34683)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=34683)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=34683)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=34683)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=34683)[0m                       'external_lib': None,
[36m(TaskRunner pid=34683)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=34683)[0m                                       'dtype': 'bfloat16',
[36m(TaskRunner pid=34683)[0m                                       'entropy_checkpointing': False,
[36m(TaskRunner pid=34683)[0m                                       'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=34683)[0m                                       'forward_only': False,
[36m(TaskRunner pid=34683)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=34683)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=34683)[0m                                       'full_determinism': False,
[36m(TaskRunner pid=34683)[0m                                       'model_dtype': 'fp32',
[36m(TaskRunner pid=34683)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=34683)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=34683)[0m                                       'param_offload': False,
[36m(TaskRunner pid=34683)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=34683)[0m                                       'seed': 42,
[36m(TaskRunner pid=34683)[0m                                       'strategy': 'fsdp',
[36m(TaskRunner pid=34683)[0m                                       'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                                       'use_orig_params': False,
[36m(TaskRunner pid=34683)[0m                                       'use_torch_compile': True,
[36m(TaskRunner pid=34683)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=34683)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=34683)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=34683)[0m                       'override_config': {},
[36m(TaskRunner pid=34683)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=34683)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=34683)[0m                       'tokenizer_path': '/home/ma-user/work/models/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=34683)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=34683)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=34683)[0m                       'use_shm': False},
[36m(TaskRunner pid=34683)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=34683)[0m                       'betas': [0.9, 0.999],
[36m(TaskRunner pid=34683)[0m                       'clip_grad': 1.0,
[36m(TaskRunner pid=34683)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=34683)[0m                       'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=34683)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=34683)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=34683)[0m                       'min_lr_ratio': 0.0,
[36m(TaskRunner pid=34683)[0m                       'num_cycles': 0.5,
[36m(TaskRunner pid=34683)[0m                       'optimizer': 'AdamW',
[36m(TaskRunner pid=34683)[0m                       'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=34683)[0m                       'override_optimizer_config': None,
[36m(TaskRunner pid=34683)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=34683)[0m                       'warmup_style': None,
[36m(TaskRunner pid=34683)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=34683)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=34683)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=34683)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=34683)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=34683)[0m             'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=34683)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=34683)[0m                          'all_ranks': False,
[36m(TaskRunner pid=34683)[0m                          'enable': False,
[36m(TaskRunner pid=34683)[0m                          'ranks': [],
[36m(TaskRunner pid=34683)[0m                          'save_path': 'outputs/profile',
[36m(TaskRunner pid=34683)[0m                          'tool': None,
[36m(TaskRunner pid=34683)[0m                          'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=34683)[0m                                                  'analysis': True,
[36m(TaskRunner pid=34683)[0m                                                  'contents': [],
[36m(TaskRunner pid=34683)[0m                                                  'discrete': False,
[36m(TaskRunner pid=34683)[0m                                                  'level': 'level0'},
[36m(TaskRunner pid=34683)[0m                                          'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=34683)[0m                                                   'discrete': False},
[36m(TaskRunner pid=34683)[0m                                          'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=34683)[0m                                                    'step_end': None,
[36m(TaskRunner pid=34683)[0m                                                    'step_start': 0},
[36m(TaskRunner pid=34683)[0m                                          'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=34683)[0m                                                           'stack_depth': 32,
[36m(TaskRunner pid=34683)[0m                                                           'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=34683)[0m             'rollout_n': 8,
[36m(TaskRunner pid=34683)[0m             'shuffle': False,
[36m(TaskRunner pid=34683)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=34683)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=34683)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=34683)[0m  'data': {'apply_chat_template_kwargs': {},
[36m(TaskRunner pid=34683)[0m           'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=34683)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=34683)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=34683)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=34683)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=34683)[0m           'image_key': 'images',
[36m(TaskRunner pid=34683)[0m           'image_patch_size': 14,
[36m(TaskRunner pid=34683)[0m           'max_prompt_length': 2048,
[36m(TaskRunner pid=34683)[0m           'max_response_length': 3072,
[36m(TaskRunner pid=34683)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=34683)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=34683)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=34683)[0m           'return_raw_chat': True,
[36m(TaskRunner pid=34683)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=34683)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=34683)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=34683)[0m           'seed': None,
[36m(TaskRunner pid=34683)[0m           'shuffle': True,
[36m(TaskRunner pid=34683)[0m           'tokenizer': None,
[36m(TaskRunner pid=34683)[0m           'tool_config_path': None,
[36m(TaskRunner pid=34683)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=34683)[0m           'train_files': '/home/ma-user/work/data/gsm8k/train.parquet',
[36m(TaskRunner pid=34683)[0m           'train_max_samples': -1,
[36m(TaskRunner pid=34683)[0m           'truncation': 'error',
[36m(TaskRunner pid=34683)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=34683)[0m           'use_shm': False,
[36m(TaskRunner pid=34683)[0m           'val_batch_size': None,
[36m(TaskRunner pid=34683)[0m           'val_files': '/home/ma-user/work/data/gsm8k/test.parquet',
[36m(TaskRunner pid=34683)[0m           'val_max_samples': -1,
[36m(TaskRunner pid=34683)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=34683)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=34683)[0m  'global_profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=34683)[0m                      'global_tool_config': {'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=34683)[0m                                                      'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=34683)[0m                                                                                    'cuda-memory-usage': 'true',
[36m(TaskRunner pid=34683)[0m                                                                                    'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=34683)[0m                                                      'discrete': False,
[36m(TaskRunner pid=34683)[0m                                                      'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=34683)[0m                                                                                'capture-range-end': None,
[36m(TaskRunner pid=34683)[0m                                                                                'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=34683)[0m                                                                                'cuda-memory-usage': 'true',
[36m(TaskRunner pid=34683)[0m                                                                                'kill': 'none',
[36m(TaskRunner pid=34683)[0m                                                                                'trace': 'cuda,nvtx,cublas,ucx'}},
[36m(TaskRunner pid=34683)[0m                                             'torch_memory': {'context': 'all',
[36m(TaskRunner pid=34683)[0m                                                              'kw_args': {},
[36m(TaskRunner pid=34683)[0m                                                              'stack_depth': 32,
[36m(TaskRunner pid=34683)[0m                                                              'stacks': 'all',
[36m(TaskRunner pid=34683)[0m                                                              'trace_alloc_max_entries': 100000}},
[36m(TaskRunner pid=34683)[0m                      'profile_continuous_steps': False,
[36m(TaskRunner pid=34683)[0m                      'save_path': 'outputs/profile',
[36m(TaskRunner pid=34683)[0m                      'steps': None,
[36m(TaskRunner pid=34683)[0m                      'tool': None},
[36m(TaskRunner pid=34683)[0m  'ray_kwargs': {'ray_init': {'num_cpus': None}, 'timeline_json_file': None},
[36m(TaskRunner pid=34683)[0m  'reward_manager': {'_target_': 'verl.trainer.config.config.RewardManagerConfig',
[36m(TaskRunner pid=34683)[0m                     'module': {'_target_': 'verl.trainer.config.config.ModuleConfig',
[36m(TaskRunner pid=34683)[0m                                'name': 'custom_reward_manager',
[36m(TaskRunner pid=34683)[0m                                'path': None},
[36m(TaskRunner pid=34683)[0m                     'name': 'naive',
[36m(TaskRunner pid=34683)[0m                     'source': 'register'},
[36m(TaskRunner pid=34683)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=34683)[0m                   'enable_resource_pool': False,
[36m(TaskRunner pid=34683)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=34683)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=34683)[0m                   'max_length': None,
[36m(TaskRunner pid=34683)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=34683)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=34683)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=34683)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=34683)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=34683)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=34683)[0m                                             'param_offload': False,
[36m(TaskRunner pid=34683)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=34683)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=34683)[0m                             'input_tokenizer': '/home/ma-user/work/models/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=34683)[0m                             'override_config': {},
[36m(TaskRunner pid=34683)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=34683)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=34683)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=34683)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=34683)[0m                             'use_shm': False},
[36m(TaskRunner pid=34683)[0m                   'n_gpus_per_node': 8,
[36m(TaskRunner pid=34683)[0m                   'nnodes': 0,
[36m(TaskRunner pid=34683)[0m                   'num_workers': 1,
[36m(TaskRunner pid=34683)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=34683)[0m                                'all_ranks': False,
[36m(TaskRunner pid=34683)[0m                                'enable': False,
[36m(TaskRunner pid=34683)[0m                                'ranks': [],
[36m(TaskRunner pid=34683)[0m                                'save_path': 'outputs/profile',
[36m(TaskRunner pid=34683)[0m                                'tool': None,
[36m(TaskRunner pid=34683)[0m                                'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=34683)[0m                                                        'analysis': True,
[36m(TaskRunner pid=34683)[0m                                                        'contents': [],
[36m(TaskRunner pid=34683)[0m                                                        'discrete': False,
[36m(TaskRunner pid=34683)[0m                                                        'level': 'level0'},
[36m(TaskRunner pid=34683)[0m                                                'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=34683)[0m /home/ma-user/work/verl/verl/trainer/main_ppo.py:307: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=34683)[0m   use_critic=need_critic(config),
[36m(TaskRunner pid=34683)[0m /home/ma-user/work/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=34683)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(TaskRunner pid=34683)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):   0%|                                                                     | 0/7473 [00:00<?, ? examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):  13%|███████▋                                                 | 1000/7473 [00:02<00:13, 495.87 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):  27%|███████████████▎                                         | 2000/7473 [00:02<00:07, 754.59 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):  40%|██████████████████████▉                                  | 3000/7473 [00:03<00:04, 955.46 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):  54%|█████████████████████████████▉                          | 4000/7473 [00:04<00:03, 1076.37 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):  67%|█████████████████████████████████████▍                  | 5000/7473 [00:05<00:02, 1162.13 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):  80%|████████████████████████████████████████████▉           | 6000/7473 [00:05<00:01, 1221.88 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):  94%|████████████████████████████████████████████████████▍   | 7000/7473 [00:06<00:00, 1261.36 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1): 100%|████████████████████████████████████████████████████████| 7473/7473 [00:06<00:00, 1273.62 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1): 100%|████████████████████████████████████████████████████████| 7473/7473 [00:07<00:00, 1059.61 examples/s]
[36m(TaskRunner pid=34683)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):   0%|                                                                     | 0/1319 [00:00<?, ? examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1):  76%|███████████████████████████████████████████▏             | 1000/1319 [00:01<00:00, 503.87 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1): 100%|█████████████████████████████████████████████████████████| 1319/1319 [00:02<00:00, 626.25 examples/s]
[36m(TaskRunner pid=34683)[0m Filtering prompts longer than 2048 tokens (num_proc=1): 100%|█████████████████████████████████████████████████████████| 1319/1319 [00:02<00:00, 553.00 examples/s]
[36m(TaskRunner pid=34683)[0m /home/ma-user/work/verl/verl/trainer/ppo/ray_trainer.py:335: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=34683)[0m   self.use_critic = need_critic(self.config)
[36m(pid=40432)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.
[36m(pid=40432)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=40432)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.
[36m(pid=40432)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=40432)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:345: ImportWarning: 
[36m(pid=40432)[0m     *************************************************************************************************************
[36m(pid=40432)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
[36m(pid=40432)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
[36m(pid=40432)[0m     The backend in torch.distributed.init_process_group set to hccl now..
[36m(pid=40432)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
[36m(pid=40432)[0m     The device parameters have been replaced with npu in the function below:
[36m(pid=40432)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
[36m(pid=40432)[0m     *************************************************************************************************************
[36m(pid=40432)[0m     
[36m(pid=40432)[0m   warnings.warn(msg, ImportWarning)
[36m(pid=40432)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
[36m(pid=40432)[0m   warnings.warn(msg, RuntimeWarning)
[36m(pid=40435)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=40435)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")[32m [repeated 14x across cluster][0m
[36m(pid=40435)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.[32m [repeated 7x across cluster][0m
[36m(pid=40432)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...
[36m(pid=40432)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=40432)[0m   import pkg_resources
[36m(pid=40432)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/ray/util/state/util.py:55: DeprecationWarning: Ray state API is no longer experimental. Please import from `ray.util.state`. instead. Importing from `ray.experimental` will be deprecated in future releases. 
[36m(pid=40432)[0m   warnings.warn(
[36m(WorkerDict pid=40432)[0m [W105 17:12:50.805811759 compiler_depend.ts:1060] Warning: The watchdog timeout 600000ms(which is set by init_process_group) is less than or equal to HCCL execution timeout 1836000ms! The plog may not be recorded. (function ProcessGroupHCCL)
[36m(WorkerDict pid=40433)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(TaskRunner pid=34683)[0m                                                         'discrete': False},
[36m(TaskRunner pid=34683)[0m                                                'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=34683)[0m                                                          'step_end': None,
[36m(TaskRunner pid=34683)[0m                                                          'step_start': 0},
[36m(TaskRunner pid=34683)[0m                                                'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=34683)[0m                                                                 'stack_depth': 32,
[36m(TaskRunner pid=34683)[0m                                                                 'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=34683)[0m                   'reward_loop_class_name': None,
[36m(TaskRunner pid=34683)[0m                   'reward_loop_module_path': None,
[36m(TaskRunner pid=34683)[0m                   'reward_loop_source': 'register',
[36m(TaskRunner pid=34683)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=34683)[0m                   'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=34683)[0m                               'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=34683)[0m                               'data_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                               'disable_log_stats': True,
[36m(TaskRunner pid=34683)[0m                               'dtype': 'bfloat16',
[36m(TaskRunner pid=34683)[0m                               'enable_chunked_prefill': True,
[36m(TaskRunner pid=34683)[0m                               'enable_prefix_caching': True,
[36m(TaskRunner pid=34683)[0m                               'enforce_eager': True,
[36m(TaskRunner pid=34683)[0m                               'engine_kwargs': {},
[36m(TaskRunner pid=34683)[0m                               'expert_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                               'free_cache_engine': True,
[36m(TaskRunner pid=34683)[0m                               'gpu_memory_utilization': 0.5,
[36m(TaskRunner pid=34683)[0m                               'limit_images': None,
[36m(TaskRunner pid=34683)[0m                               'load_format': 'auto',
[36m(TaskRunner pid=34683)[0m                               'max_model_len': None,
[36m(TaskRunner pid=34683)[0m                               'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=34683)[0m                               'max_num_seqs': 1024,
[36m(TaskRunner pid=34683)[0m                               'name': '???',
[36m(TaskRunner pid=34683)[0m                               'prompt_length': 2048,
[36m(TaskRunner pid=34683)[0m                               'response_length': 2048,
[36m(TaskRunner pid=34683)[0m                               'skip_tokenizer_init': False,
[36m(TaskRunner pid=34683)[0m                               'tensor_model_parallel_size': 2},
[36m(TaskRunner pid=34683)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=34683)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=34683)[0m                                      'url': None},
[36m(TaskRunner pid=34683)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=34683)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=34683)[0m                   'use_dynamic_bsz': False,
[36m(TaskRunner pid=34683)[0m                   'use_reward_loop': True},
[36m(TaskRunner pid=34683)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=34683)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=34683)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=34683)[0m              'default_local_dir': 'checkpoints/verl_grpo_example_gsm8k/qwen2_7b_function_rm',
[36m(TaskRunner pid=34683)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=34683)[0m              'device': 'npu',
[36m(TaskRunner pid=34683)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=34683)[0m              'experiment_name': 'qwen2_7b_function_rm',
[36m(TaskRunner pid=34683)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=34683)[0m              'logger': 'console',
[36m(TaskRunner pid=34683)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=34683)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=34683)[0m              'n_gpus_per_node': 4,
[36m(TaskRunner pid=34683)[0m              'nnodes': 1,
[36m(TaskRunner pid=34683)[0m              'project_name': 'verl_grpo_example_gsm8k',
[36m(TaskRunner pid=34683)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=34683)[0m              'resume_from_path': None,
[36m(TaskRunner pid=34683)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=34683)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=34683)[0m              'save_freq': -1,
[36m(TaskRunner pid=34683)[0m              'test_freq': 5,
[36m(TaskRunner pid=34683)[0m              'total_epochs': 1,
[36m(TaskRunner pid=34683)[0m              'total_training_steps': None,
[36m(TaskRunner pid=34683)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=34683)[0m              'val_before_train': True,
[36m(TaskRunner pid=34683)[0m              'val_only': False,
[36m(TaskRunner pid=34683)[0m              'validation_data_dir': None},
[36m(TaskRunner pid=34683)[0m  'transfer_queue': {'enable': False}}
[36m(TaskRunner pid=34683)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=34683)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=34683)[0m dataset len: 7473
[36m(TaskRunner pid=34683)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:12:19,571 WARNING [datasets.arrow_dataset:3258] => Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=34683)[0m filter dataset len: 7473
[36m(TaskRunner pid=34683)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=34683)[0m dataset len: 1319
[36m(TaskRunner pid=34683)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:12:28,158 WARNING [datasets.arrow_dataset:3258] => Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=34683)[0m filter dataset len: 1319
[36m(TaskRunner pid=34683)[0m Size of train dataloader: 58, Size of val dataloader: 1
[36m(TaskRunner pid=34683)[0m Total training steps: 58
[36m(TaskRunner pid=34683)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(TaskRunner pid=34683)[0m bind role actor_rollout method chat_completion to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=34683)[0m bind role actor_rollout method generate to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=34683)[0m bind role actor_rollout method get_zeromq_address to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=34683)[0m bind role actor_rollout method sleep to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=34683)[0m bind role actor_rollout method wake_up to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(pid=40432)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:12:47,554 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
[36m(WorkerDict pid=40432)[0m reference model: /home/ma-user/work/models/Qwen2.5-0.5B-Instruct
[36m(WorkerDict pid=40435)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch
[36m(pid=40433)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...[32m [repeated 3x across cluster][0m
[36m(pid=40433)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/ray/util/state/util.py:55: DeprecationWarning: Ray state API is no longer experimental. Please import from `ray.util.state`. instead. Importing from `ray.experimental` will be deprecated in future releases. [32m [repeated 3x across cluster][0m
[36m(pid=40433)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=40432)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=40433)[0m /home/ma-user/work/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(WorkerDict pid=40433)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(WorkerDict pid=40434)[0m <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute
[36m(WorkerDict pid=40434)[0m <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute
[36m(WorkerDict pid=40434)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:680: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=40434)[0m   warnings.warn(
[36m(WorkerDict pid=40432)[0m /home/ma-user/work/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=40432)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)[32m [repeated 3x across cluster][0m
[36m(pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.
[36m(pid=42679)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.
[36m(pid=42679)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(TaskRunner pid=34683)[0m <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute[32m [repeated 4x across cluster][0m
[36m(TaskRunner pid=34683)[0m <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=40433)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:680: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=40433)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=34683)[0m /home/ma-user/work/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=34683)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=42679)[0m   import pkg_resources
[36m(pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.[32m [repeated 3x across cluster][0m
[36m(pid=42692)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")[32m [repeated 6x across cluster][0m
[36m(pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.[32m [repeated 3x across cluster][0m
[36m(pid=40433)[0m [Rank 1 | Local Rank 0] 2026-01-05 17:12:48,428 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=40432)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=40432)[0m   "architectures": [
[36m(WorkerDict pid=40432)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=40432)[0m   ],
[36m(WorkerDict pid=40432)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=40432)[0m   "dtype": "bfloat16",
[36m(WorkerDict pid=40432)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=40432)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=40432)[0m   "hidden_size": 896,
[36m(WorkerDict pid=40432)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=40432)[0m   "intermediate_size": 4864,
[36m(WorkerDict pid=40432)[0m   "layer_types": [
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention"
[36m(WorkerDict pid=40432)[0m   ],
[36m(WorkerDict pid=40432)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=40432)[0m   "max_window_layers": 21,
[36m(WorkerDict pid=40432)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=40432)[0m   "num_attention_heads": 14,
[36m(WorkerDict pid=40432)[0m   "num_hidden_layers": 24,
[36m(WorkerDict pid=40432)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=40432)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=40432)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=40432)[0m   "rope_scaling": null,
[36m(WorkerDict pid=40432)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=40432)[0m   "sliding_window": null,
[36m(WorkerDict pid=40432)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=40432)[0m   "transformers_version": "4.57.3",
[36m(WorkerDict pid=40432)[0m   "use_cache": true,
[36m(WorkerDict pid=40432)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=40432)[0m   "vocab_size": 151936
[36m(WorkerDict pid=40432)[0m }
[36m(WorkerDict pid=40432)[0m 
[36m(WorkerDict pid=40432)[0m Qwen2ForCausalLM contains 494.03M parameters
[36m(WorkerDict pid=40432)[0m wrap_policy: functools.partial(<function _or_policy at 0xffd0250593f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0xffd0250592d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=40432)[0m Ref use_remove_padding=False
[36m(WorkerDict pid=40432)[0m Ref use_fused_kernels=False
[36m(WorkerDict pid=40432)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=40432)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=40432)[0m   "architectures": [
[36m(WorkerDict pid=40432)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=40432)[0m   ],
[36m(WorkerDict pid=40432)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=40432)[0m   "dtype": "bfloat16",
[36m(WorkerDict pid=40432)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=40432)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=40432)[0m   "hidden_size": 896,
[36m(WorkerDict pid=40432)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=40432)[0m   "intermediate_size": 4864,
[36m(WorkerDict pid=40432)[0m   "layer_types": [
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention",
[36m(WorkerDict pid=40432)[0m     "full_attention"
[36m(WorkerDict pid=40432)[0m   ],
[36m(WorkerDict pid=40432)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=40432)[0m   "max_window_layers": 21,
[36m(WorkerDict pid=40432)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=40432)[0m   "num_attention_heads": 14,
[36m(WorkerDict pid=40432)[0m   "num_hidden_layers": 24,
[36m(WorkerDict pid=40432)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=40432)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=40432)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=40432)[0m   "rope_scaling": null,
[36m(WorkerDict pid=40432)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=40432)[0m   "sliding_window": null,
[36m(WorkerDict pid=40432)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=40432)[0m   "transformers_version": "4.57.3",
[36m(WorkerDict pid=40432)[0m   "use_cache": true,
[36m(WorkerDict pid=40432)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=40432)[0m   "vocab_size": 151936
[36m(WorkerDict pid=40432)[0m }
[36m(WorkerDict pid=40432)[0m 
[36m(WorkerDict pid=40432)[0m Qwen2ForCausalLM contains 494.03M parameters
[36m(WorkerDict pid=40432)[0m wrap_policy: functools.partial(<function _or_policy at 0xffd0250593f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0xffd0250592d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=40432)[0m Total steps: 58, num_warmup_steps: 0
[36m(WorkerDict pid=40432)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=40432)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=40434)[0m WARNING 01-05 17:13:18 [_custom_ops.py:20] Failed to import from vllm._C with ModuleNotFoundError("No module named 'vllm._C'")
[36m(WorkerDict pid=40433)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 4x across cluster][0m
[36m(TaskRunner pid=34683)[0m WARNING 01-05 17:13:23 [api_server.py:1213] LoRA dynamic loading & unloading is enabled in the API server. This should ONLY be used for local development!
[36m(pid=42679)[0m WARNING 01-05 17:13:40 [_custom_ops.py:20] Failed to import from vllm._C with ModuleNotFoundError("No module named 'vllm._C'")[32m [repeated 5x across cluster][0m
[36m(pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
[36m(pid=42679)[0m     *************************************************************************************************************
[36m(pid=42679)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
[36m(pid=42679)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
[36m(pid=42679)[0m     The backend in torch.distributed.init_process_group set to hccl now..
[36m(pid=42679)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
[36m(pid=42679)[0m     The device parameters have been replaced with npu in the function below:
[36m(pid=42679)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
[36m(pid=42679)[0m     *************************************************************************************************************
[36m(pid=42679)[0m     
[36m(pid=42679)[0m   warnings.warn(msg, ImportWarning)
[36m(pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
[36m(pid=42679)[0m   warnings.warn(msg, RuntimeWarning)
[36m(pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=42692)[0m   import pkg_resources
[36m(pid=42679)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...
[36m(pid=42692)[0m     
[36m(vLLMHttpServer pid=42679)[0m Using blocking ray.get inside async actor. This blocks the event loop. Please use `await` on object ref with asyncio.gather if you want to yield execution to the event loop instead.
[36m(vLLMHttpServer pid=42679)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(vLLMHttpServer pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.
[36m(vLLMHttpServer pid=42679)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(vLLMHttpServer pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.
[36m(vLLMHttpServer pid=42679)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
[36m(pid=42692)[0m     *************************************************************************************************************[32m [repeated 2x across cluster][0m
[36m(pid=42692)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
[36m(pid=42692)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
[36m(pid=42692)[0m     The backend in torch.distributed.init_process_group set to hccl now..
[36m(pid=42692)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
[36m(pid=42692)[0m     The device parameters have been replaced with npu in the function below:
[36m(pid=42692)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
[36m(pid=42692)[0m   warnings.warn(msg, ImportWarning)
[36m(pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
[36m(pid=42692)[0m   warnings.warn(msg, RuntimeWarning)
[36m(pid=42692)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...
[36m(vLLMHttpServer pid=42692)[0m Using blocking ray.get inside async actor. This blocks the event loop. Please use `await` on object ref with asyncio.gather if you want to yield execution to the event loop instead.
[36m(vLLMHttpServer pid=42692)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(vLLMHttpServer pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(vLLMHttpServer pid=42679)[0m   import pkg_resources
[36m(vLLMHttpServer pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.[32m [repeated 3x across cluster][0m
[36m(vLLMHttpServer pid=42692)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")[32m [repeated 6x across cluster][0m
[36m(vLLMHttpServer pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.[32m [repeated 3x across cluster][0m
[36m(pid=42679)[0m WARNING 01-05 17:13:42 [api_server.py:1213] LoRA dynamic loading & unloading is enabled in the API server. This should ONLY be used for local development!
[36m(pid=42679)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:42,524 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
[36m(vLLMHttpServer pid=42679)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:44,233 INFO [/home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:217] => vLLMHttpServer, replica_rank: 0, master address: 172.16.0.134, master port: 33895, data parallel master port: 34489
[36m(vLLMHttpServer pid=42679)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:44,241 INFO [/home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:257] => override_generation_config: {'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'repetition_penalty': 1.0, 'max_new_tokens': 3072}
[36m(vLLMHttpServer pid=42679)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:44,241 INFO [/home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:259] => enable_sleep_mode: True
[36m(vLLMHttpServer pid=42679)[0m ['serve',
[36m(vLLMHttpServer pid=42679)[0m  '/home/ma-user/work/models/Qwen2.5-0.5B-Instruct',
[36m(vLLMHttpServer pid=42679)[0m  '--dtype',
[36m(vLLMHttpServer pid=42679)[0m  'bfloat16',
[36m(vLLMHttpServer pid=42679)[0m  '--load_format',
[36m(vLLMHttpServer pid=42679)[0m  'dummy',
[36m(vLLMHttpServer pid=42679)[0m  '--max_model_len',
[36m(vLLMHttpServer pid=42679)[0m  '5120',
[36m(vLLMHttpServer pid=42679)[0m  '--max_num_seqs',
[36m(vLLMHttpServer pid=42679)[0m  '1024',
[36m(vLLMHttpServer pid=42679)[0m  '--max_num_batched_tokens',
[36m(vLLMHttpServer pid=42679)[0m  '8192',
[36m(vLLMHttpServer pid=42679)[0m  '--enable_prefix_caching',
[36m(vLLMHttpServer pid=42679)[0m  '--enable_sleep_mode',
[36m(vLLMHttpServer pid=42679)[0m  '--disable_custom_all_reduce',
[36m(vLLMHttpServer pid=42679)[0m  '--gpu_memory_utilization',
[36m(vLLMHttpServer pid=42679)[0m  '0.7',
[36m(vLLMHttpServer pid=42679)[0m  '--disable_log_stats',
[36m(vLLMHttpServer pid=42679)[0m  '--tensor_parallel_size',
[36m(vLLMHttpServer pid=42679)[0m  '2',
[36m(vLLMHttpServer pid=42679)[0m  '--seed',
[36m(vLLMHttpServer pid=42679)[0m  '0',
[36m(vLLMHttpServer pid=42679)[0m  '--override_generation_config',
[36m(vLLMHttpServer pid=42679)[0m  '{"temperature": 1.0, "top_k": -1, "top_p": 1, "repetition_penalty": 1.0, '
[36m(vLLMHttpServer pid=42679)[0m  '"max_new_tokens": 3072}',
[36m(vLLMHttpServer pid=42679)[0m  '--hf_overrides',
[36m(vLLMHttpServer pid=42679)[0m  '{}']
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:44 [registry.py:582] Model architecture Qwen2VLForConditionalGeneration is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen2_vl:AscendQwen2VLForConditionalGeneration.
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:44 [registry.py:582] Model architecture Qwen3VLMoeForConditionalGeneration is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen2_5_vl_without_padding:AscendQwen3VLMoeForConditionalGeneration.
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:44 [registry.py:582] Model architecture Qwen3VLForConditionalGeneration is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen2_5_vl_without_padding:AscendQwen3VLForConditionalGeneration.
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:44 [registry.py:582] Model architecture Qwen2_5_VLForConditionalGeneration is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen2_5_vl:AscendQwen2_5_VLForConditionalGeneration.
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:44 [registry.py:582] Model architecture Qwen2_5OmniModel is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen2_5_omni_thinker:AscendQwen2_5OmniThinkerForConditionalGeneration.
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:44 [registry.py:582] Model architecture DeepseekV32ForCausalLM is already registered, and will be overwritten by the new model class vllm_ascend.models.deepseek_v3_2:CustomDeepseekV3ForCausalLM.
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:44 [registry.py:582] Model architecture Qwen3NextForCausalLM is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen3_next:CustomQwen3NextForCausalLM.
[36m(vLLMHttpServer pid=42679)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:44,389 INFO [/home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:389] => replica_rank=0, node_rank=0, nnodes=1, get worker zmq addresses: ['ipc:///tmp/verl_vllm_zmq_40432_ma-user.ipc', 'ipc:///tmp/verl_vllm_zmq_40433_ma-user.ipc']
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:44 [utils.py:396] Currently, communication is performed using FFTS+ method, which reduces the number of available streams and, as a result, limits the range of runtime shapes that can be handled. To both improve communication performance and increase the number of supported shapes, set HCCL_OP_EXPANSION_MODE=AIV.
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:44 [platform.py:270] If chunked prefill or prefix caching is enabled, block size must be set to 128.
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:13:45 [__init__.py:3036] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/usage/troubleshooting.html#python-multiprocessing for more information. Reasons: In a Ray actor and can only be spawned
[36m(pid=42692)[0m WARNING 01-05 17:13:41 [_custom_ops.py:20] Failed to import from vllm._C with ModuleNotFoundError("No module named 'vllm._C'")
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:14:01 [_custom_ops.py:20] Failed to import from vllm._C with ModuleNotFoundError("No module named 'vllm._C'")
[36m(pid=42692)[0m WARNING 01-05 17:13:42 [api_server.py:1213] LoRA dynamic loading & unloading is enabled in the API server. This should ONLY be used for local development!
[36m(pid=42692)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:43,452 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
[36m(vLLMHttpServer pid=42692)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:45,086 INFO [/home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:217] => vLLMHttpServer, replica_rank: 1, master address: 172.16.0.134, master port: 41177, data parallel master port: 37177
[36m(vLLMHttpServer pid=42692)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:45,094 INFO [/home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:257] => override_generation_config: {'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'repetition_penalty': 1.0, 'max_new_tokens': 3072}
[36m(vLLMHttpServer pid=42692)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:45,094 INFO [/home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:259] => enable_sleep_mode: True
[36m(vLLMHttpServer pid=42692)[0m WARNING 01-05 17:13:45 [registry.py:582] Model architecture Qwen3NextForCausalLM is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen3_next:CustomQwen3NextForCausalLM.[32m [repeated 7x across cluster][0m
[36m(vLLMHttpServer pid=42692)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:13:45,212 INFO [/home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:389] => replica_rank=1, node_rank=0, nnodes=1, get worker zmq addresses: ['ipc:///tmp/verl_vllm_zmq_40434_ma-user.ipc', 'ipc:///tmp/verl_vllm_zmq_40435_ma-user.ipc']
[36m(vLLMHttpServer pid=42692)[0m WARNING 01-05 17:13:45 [utils.py:396] Currently, communication is performed using FFTS+ method, which reduces the number of available streams and, as a result, limits the range of runtime shapes that can be handled. To both improve communication performance and increase the number of supported shapes, set HCCL_OP_EXPANSION_MODE=AIV.
[36m(vLLMHttpServer pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
[36m(vLLMHttpServer pid=42679)[0m     *************************************************************************************************************
[36m(vLLMHttpServer pid=42679)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
[36m(vLLMHttpServer pid=42679)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
[36m(vLLMHttpServer pid=42679)[0m     The backend in torch.distributed.init_process_group set to hccl now..
[36m(vLLMHttpServer pid=42679)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
[36m(vLLMHttpServer pid=42679)[0m     The device parameters have been replaced with npu in the function below:
[36m(vLLMHttpServer pid=42679)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
[36m(vLLMHttpServer pid=42679)[0m     *************************************************************************************************************
[36m(vLLMHttpServer pid=42679)[0m     
[36m(vLLMHttpServer pid=42679)[0m   warnings.warn(msg, ImportWarning)
[36m(vLLMHttpServer pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
[36m(vLLMHttpServer pid=42679)[0m   warnings.warn(msg, RuntimeWarning)
[36m(vLLMHttpServer pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(vLLMHttpServer pid=42692)[0m   import pkg_resources
[36m(vLLMHttpServer pid=42679)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...
[36m(vLLMHttpServer pid=42692)[0m     
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):   0%|                                                                              | 0/23 [00:00<?, ?it/s]
[36m(vLLMHttpServer pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
[36m(vLLMHttpServer pid=42692)[0m     *************************************************************************************************************[32m [repeated 2x across cluster][0m
[36m(vLLMHttpServer pid=42692)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
[36m(vLLMHttpServer pid=42692)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
[36m(vLLMHttpServer pid=42692)[0m     The backend in torch.distributed.init_process_group set to hccl now..
[36m(vLLMHttpServer pid=42692)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
[36m(vLLMHttpServer pid=42692)[0m     The device parameters have been replaced with npu in the function below:
[36m(vLLMHttpServer pid=42692)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
[36m(vLLMHttpServer pid=42692)[0m   warnings.warn(msg, ImportWarning)
[36m(vLLMHttpServer pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
[36m(vLLMHttpServer pid=42692)[0m   warnings.warn(msg, RuntimeWarning)
[36m(vLLMHttpServer pid=42692)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):   9%|██████                                                                | 2/23 [00:00<00:01, 12.78it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  17%|████████████▏                                                         | 4/23 [00:00<00:01, 13.12it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  26%|██████████████████▎                                                   | 6/23 [00:00<00:01, 13.08it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  35%|████████████████████████▎                                             | 8/23 [00:00<00:01, 13.13it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  43%|██████████████████████████████                                       | 10/23 [00:00<00:00, 13.05it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  52%|████████████████████████████████████                                 | 12/23 [00:00<00:00, 13.10it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  61%|██████████████████████████████████████████                           | 14/23 [00:01<00:00, 13.02it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  70%|████████████████████████████████████████████████                     | 16/23 [00:01<00:00, 12.69it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  78%|██████████████████████████████████████████████████████               | 18/23 [00:01<00:00, 12.70it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  87%|████████████████████████████████████████████████████████████         | 20/23 [00:01<00:00, 12.75it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE):  96%|██████████████████████████████████████████████████████████████████   | 22/23 [00:01<00:00, 12.81it/s]
[36m(WorkerDict pid=40432)[0m Capturing ACL graphs (mixed prefill-decode, PIECEWISE): 100%|█████████████████████████████████████████████████████████████████████| 23/23 [00:01<00:00, 12.93it/s]
[36m(vLLMHttpServer pid=42679)[0m [1;36m(EngineCore_DP0 pid=43589)[0;0m /home/ma-user/.conda/envs/test01/lib/python3.10/contextlib.py:142: ResourceWarning: Unclosed context <zmq.Context() at 0xffff1f933c40>
[36m(vLLMHttpServer pid=42679)[0m [1;36m(EngineCore_DP0 pid=43589)[0;0m   next(self.gen)
[36m(vLLMHttpServer pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/websockets/legacy/__init__.py:6: DeprecationWarning: websockets.legacy is deprecated; see https://websockets.readthedocs.io/en/stable/howto/upgrade.html for upgrade instructions
[36m(vLLMHttpServer pid=42679)[0m   warnings.warn(  # deprecated in 14.0 - 2024-11-09
[36m(vLLMHttpServer pid=42679)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/uvicorn/protocols/websockets/websockets_impl.py:17: DeprecationWarning: websockets.server.WebSocketServerProtocol is deprecated
[36m(vLLMHttpServer pid=42679)[0m   from websockets.server import WebSocketServerProtocol
[36m(vLLMHttpServer pid=42679)[0m /home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:428: ResourceWarning: unclosed <socket.socket fd=77, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.16.0.134', 38027)>
[36m(vLLMHttpServer pid=42679)[0m   self._server_port, self._server_task = await run_unvicorn(app, args, self._server_address)
[36m(pid=44555)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.
[36m(pid=44555)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=44555)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.
[36m(pid=44555)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(vLLMHttpServer pid=42692)[0m [1;36m(EngineCore_DP0 pid=43645)[0;0m /home/ma-user/.conda/envs/test01/lib/python3.10/contextlib.py:142: ResourceWarning: Unclosed context <zmq.Context() at 0xffff1ec43c90>
[36m(vLLMHttpServer pid=42692)[0m [1;36m(EngineCore_DP0 pid=43645)[0;0m   next(self.gen)
[36m(vLLMHttpServer pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/websockets/legacy/__init__.py:6: DeprecationWarning: websockets.legacy is deprecated; see https://websockets.readthedocs.io/en/stable/howto/upgrade.html for upgrade instructions
[36m(vLLMHttpServer pid=42692)[0m   warnings.warn(  # deprecated in 14.0 - 2024-11-09
[36m(vLLMHttpServer pid=42692)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/uvicorn/protocols/websockets/websockets_impl.py:17: DeprecationWarning: websockets.server.WebSocketServerProtocol is deprecated
[36m(vLLMHttpServer pid=42692)[0m   from websockets.server import WebSocketServerProtocol
[36m(vLLMHttpServer pid=42692)[0m /home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:428: ResourceWarning: unclosed <socket.socket fd=77, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.16.0.134', 39491)>
[36m(vLLMHttpServer pid=42692)[0m   self._server_port, self._server_task = await run_unvicorn(app, args, self._server_address)
[36m(pid=44555)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
[36m(pid=44555)[0m     *************************************************************************************************************
[36m(pid=44555)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
[36m(pid=44555)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
[36m(pid=44555)[0m     The backend in torch.distributed.init_process_group set to hccl now..
[36m(pid=44555)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
[36m(pid=44555)[0m     The device parameters have been replaced with npu in the function below:
[36m(pid=44555)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
[36m(pid=44555)[0m     *************************************************************************************************************
[36m(pid=44555)[0m     
[36m(pid=44555)[0m   warnings.warn(msg, ImportWarning)
[36m(pid=44555)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
[36m(pid=44555)[0m   warnings.warn(msg, RuntimeWarning)
[36m(pid=44591)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.[32m [repeated 15x across cluster][0m
[36m(pid=44591)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")[32m [repeated 30x across cluster][0m
[36m(pid=44591)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.[32m [repeated 15x across cluster][0m
[36m(pid=44555)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...
[36m(pid=44555)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=44555)[0m   import pkg_resources
[36m(pid=44572)[0m     
[36m(pid=44573)[0m     
[36m(pid=44567)[0m     
[36m(pid=44586)[0m     
[36m(pid=44592)[0m     
[36m(pid=44587)[0m     
[36m(pid=44591)[0m     
[36m(AgentLoopWorker pid=44555)[0m <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute
[36m(AgentLoopWorker pid=44555)[0m <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute
[36m(pid=44591)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: [32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m     *************************************************************************************************************[32m [repeated 14x across cluster][0m
[36m(pid=44591)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m     The backend in torch.distributed.init_process_group set to hccl now..[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m     The device parameters have been replaced with npu in the function below:[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m   warnings.warn(msg, ImportWarning)[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m   warnings.warn(msg, RuntimeWarning)[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.[32m [repeated 7x across cluster][0m
[36m(pid=44591)[0m   import pkg_resources[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=40432)[0m [rank0]:[W105 17:14:39.522764354 compiler_depend.ts:117] Warning: Driver Version: 9 is invalid or not supported yet. (function operator())
[36m(pid=46505)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.
[36m(pid=46505)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(pid=46505)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.
[36m(pid=46505)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")
[36m(AgentLoopWorker pid=44591)[0m <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute[32m [repeated 7x across cluster][0m
[36m(AgentLoopWorker pid=44591)[0m <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute[32m [repeated 7x across cluster][0m
[36m(AgentLoopWorker pid=44587)[0m You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
[36m(pid=47345)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/latest owner does not match the current owner.[32m [repeated 15x across cluster][0m
[36m(pid=47345)[0m   warnings.warn(f"Warning: The {path} owner does not match the current owner.")[32m [repeated 30x across cluster][0m
[36m(pid=47345)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/utils/collect_env.py:58: UserWarning: Warning: The /usr/local/Ascend/ascend-toolkit/8.3.RC1.alpha003/aarch64-linux/ascend_toolkit_install.info owner does not match the current owner.[32m [repeated 15x across cluster][0m
[36m(pid=46505)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
[36m(pid=46505)[0m     *************************************************************************************************************
[36m(pid=46505)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
[36m(pid=46505)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
[36m(pid=46505)[0m     The backend in torch.distributed.init_process_group set to hccl now..
[36m(pid=46505)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
[36m(pid=46505)[0m     The device parameters have been replaced with npu in the function below:
[36m(pid=46505)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
[36m(pid=46505)[0m     *************************************************************************************************************
[36m(pid=46505)[0m     
[36m(pid=46505)[0m   warnings.warn(msg, ImportWarning)
[36m(pid=46505)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
[36m(pid=46505)[0m   warnings.warn(msg, RuntimeWarning)
[36m(AgentLoopWorker pid=44586)[0m You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.[32m [repeated 7x across cluster][0m
[36m(pid=46505)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...
[36m(pid=46505)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=46505)[0m   import pkg_resources
[36m(pid=46614)[0m     
[36m(vLLMHttpServer pid=42692)[0m WARNING 01-05 17:13:45 [platform.py:270] If chunked prefill or prefix caching is enabled, block size must be set to 128.
[36m(vLLMHttpServer pid=42692)[0m WARNING 01-05 17:13:45 [__init__.py:3036] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/usage/troubleshooting.html#python-multiprocessing for more information. Reasons: In a Ray actor and can only be spawned
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:14:02 [api_server.py:1213] LoRA dynamic loading & unloading is enabled in the API server. This should ONLY be used for local development!
[36m(vLLMHttpServer pid=42679)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:03,769 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
[36m(WorkerDict pid=40432)[0m WARNING 01-05 17:14:09 [cudagraph_dispatcher.py:106] cudagraph dispatching keys are not initialized. No cudagraph will be used.
[36m(vLLMHttpServer pid=42692)[0m WARNING 01-05 17:14:02 [_custom_ops.py:20] Failed to import from vllm._C with ModuleNotFoundError("No module named 'vllm._C'")
[36m(WorkerDict pid=40435)[0m WARNING 01-05 17:14:05 [registry.py:582] Model architecture Qwen3NextForCausalLM is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen3_next:CustomQwen3NextForCausalLM.[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=40435)[0m WARNING 01-05 17:14:05 [api_server.py:1213] LoRA dynamic loading & unloading is enabled in the API server. This should ONLY be used for local development![32m [repeated 5x across cluster][0m
[36m(vLLMHttpServer pid=42692)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:04,793 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
[36m(vLLMHttpServer pid=42679)[0m [1;36m(EngineCore_DP0 pid=43589)[0;0m WARNING 01-05 17:14:15 [utils.py:396] Currently, communication is performed using FFTS+ method, which reduces the number of available streams and, as a result, limits the range of runtime shapes that can be handled. To both improve communication performance and increase the number of supported shapes, set HCCL_OP_EXPANSION_MODE=AIV.
[36m(vLLMHttpServer pid=42679)[0m [1;36m(EngineCore_DP0 pid=43589)[0;0m WARNING 01-05 17:14:15 [platform.py:270] If chunked prefill or prefix caching is enabled, block size must be set to 128.
[36m(WorkerDict pid=40435)[0m WARNING 01-05 17:14:10 [cudagraph_dispatcher.py:106] cudagraph dispatching keys are not initialized. No cudagraph will be used.[32m [repeated 3x across cluster][0m
[36m(vLLMHttpServer pid=42679)[0m WARNING 01-05 17:14:15 [model.py:1389] Default sampling parameters have been overridden by the model's Hugging Face generation config recommended from the model creator. If this is not intended, please relaunch vLLM instance with `--generation-config vllm`.
[36m(vLLMHttpServer pid=42679)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:15,697 INFO [/home/ma-user/work/verl/verl/workers/rollout/vllm_rollout/vllm_async_server.py:425] => Initializing a V1 LLM engine with config: model='/home/ma-user/work/models/Qwen2.5-0.5B-Instruct', speculative_config=None, tokenizer='/home/ma-user/work/models/Qwen2.5-0.5B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=5120, download_dir=None, load_format=dummy, tensor_parallel_size=2, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=True, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=npu, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=/home/ma-user/work/models/Qwen2.5-0.5B-Instruct, enable_prefix_caching=True, chunked_prefill_enabled=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":["all"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output","vllm.mamba_mixer2","vllm.mamba_mixer","vllm.short_conv","vllm.linear_attention","vllm.plamo2_mamba_mixer","vllm.gdn_attention","vllm.sparse_attn_indexer","vllm.unified_ascend_attention_with_output","vllm.mla_forward"],"use_inductor":false,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"cudagraph_mode":1,"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,488,464,440,416,392,368,344,320,296,272,248,224,200,176,152,128,104,80,56,32,8,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"use_inductor_graph_partition":false,"pass_config":{},"max_capture_size":512,"local_cache_dir":null}
[36m(vLLMHttpServer pid=42679)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:16,311 INFO [/home/ma-user/work/verl/verl/workers/rollout/utils.py:67] => HTTP server started on port 38027
[36m(TaskRunner pid=34683)[0m AgentLoopManager: ['172.16.0.134:38027', '172.16.0.134:39491']
[36m(TaskRunner pid=34683)[0m Checkpoint tracker file does not exist: /home/ma-user/work/checkpoints/verl_grpo_example_gsm8k/qwen2_7b_function_rm/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=34683)[0m Training from scratch
[36m(vLLMHttpServer pid=42692)[0m [1;36m(EngineCore_DP0 pid=43645)[0;0m WARNING 01-05 17:14:15 [utils.py:396] Currently, communication is performed using FFTS+ method, which reduces the number of available streams and, as a result, limits the range of runtime shapes that can be handled. To both improve communication performance and increase the number of supported shapes, set HCCL_OP_EXPANSION_MODE=AIV.
[36m(vLLMHttpServer pid=42692)[0m [1;36m(EngineCore_DP0 pid=43645)[0;0m WARNING 01-05 17:14:15 [platform.py:270] If chunked prefill or prefix caching is enabled, block size must be set to 128.
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 0}
[36m(vLLMHttpServer pid=42692)[0m WARNING 01-05 17:14:16 [model.py:1389] Default sampling parameters have been overridden by the model's Hugging Face generation config recommended from the model creator. If this is not intended, please relaunch vLLM instance with `--generation-config vllm`.
[36m(vLLMHttpServer pid=42692)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:17,010 INFO [/home/ma-user/work/verl/verl/workers/rollout/utils.py:67] => HTTP server started on port 39491
[36m(pid=44555)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:32,900 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
[36m(AgentLoopWorker pid=44555)[0m WARNING 01-05 17:14:37 [_custom_ops.py:20] Failed to import from vllm._C with ModuleNotFoundError("No module named 'vllm._C'")
[36m(AgentLoopWorker pid=44555)[0m WARNING 01-05 17:14:38 [api_server.py:1213] LoRA dynamic loading & unloading is enabled in the API server. This should ONLY be used for local development!
[36m(pid=44591)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:34,513 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.[32m [repeated 7x across cluster][0m
[36m(AgentLoopWorker pid=44591)[0m WARNING 01-05 17:14:39 [_custom_ops.py:20] Failed to import from vllm._C with ModuleNotFoundError("No module named 'vllm._C'")[32m [repeated 7x across cluster][0m
[36m(AgentLoopWorker pid=44591)[0m WARNING 01-05 17:14:40 [api_server.py:1213] LoRA dynamic loading & unloading is enabled in the API server. This should ONLY be used for local development![32m [repeated 7x across cluster][0m
[36m(pid=46505)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:54,630 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
[36m(pid=46719)[0m     
[36m(pid=46835)[0m     
[36m(pid=46950)[0m     
[36m(pid=47160)[0m     
[36m(pid=46839)[0m     
[36m(pid=47345)[0m     
[36m(TaskRunner pid=34683)[0m Training Progress:   0%|                                                                                                                   | 0/58 [00:00<?, ?it/s]
[36m(pid=47345)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: [32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m     *************************************************************************************************************[32m [repeated 14x across cluster][0m
[36m(pid=47345)[0m     The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m     The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m     The backend in torch.distributed.init_process_group set to hccl now..[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m     The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m     The device parameters have been replaced with npu in the function below:[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m     torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m   warnings.warn(msg, ImportWarning)[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m   warnings.warn(msg, RuntimeWarning)[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m Using /home/ma-user/.cache/torch_extensions/py310_cpu as PyTorch extensions root...[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m /home/ma-user/.conda/envs/test01/lib/python3.10/site-packages/torch_npu/dynamo/torchair/__init__.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.[32m [repeated 7x across cluster][0m
[36m(pid=47345)[0m   import pkg_resources[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=34683)[0m Training Progress:   2%|█▊                                                                                                      | 1/58 [04:47<4:32:56, 287.31s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:   3%|███▌                                                                                                    | 2/58 [11:40<5:37:11, 361.27s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:   5%|█████▍                                                                                                  | 3/58 [15:44<4:42:02, 307.68s/it]
[36m(pid=46614)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:55,377 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(pid=47345)[0m [Rank 0 | Local Rank 0] 2026-01-05 17:14:56,919 INFO [mindspeed.megatron_adaptor:33] => start to patch features in megatron adaptor.[32m [repeated 6x across cluster][0m
[36m(TaskRunner pid=34683)[0m ("Initial validation metrics: {'val-aux/openai/gsm8k/reward/mean@1': 0.0, "
[36m(TaskRunner pid=34683)[0m  "'val-core/openai/gsm8k/acc/mean@1': 0.0, 'val-aux/num_turns/min': 2, "
[36m(TaskRunner pid=34683)[0m  "'val-aux/num_turns/max': 2, 'val-aux/num_turns/mean': 2.0}")
[36m(TaskRunner pid=34683)[0m step:0 - val-aux/openai/gsm8k/reward/mean@1:0.0 - val-core/openai/gsm8k/acc/mean@1:0.0 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0
[36m(TaskRunner pid=34683)[0m step:1 - actor/entropy:0.48840805565123446 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:8.947905371314846e-06 - actor/ppo_kl:4.597546276219333e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:1.8116406863555312e-06 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.7553935108605145e-05 - actor/grad_norm:0.19641831144690514 - perf/mfu/actor:0.013740821893729384 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:74.875 - perf/cpu_memory_used_gb:84.494384765625 - actor/lr:5e-07 - training/global_step:1 - training/epoch:0 - critic/score/mean:0.00390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.00390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0007166378200054169 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.35355237126350403 - critic/returns/mean:-0.0007166378200054169 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.35355237126350403 - response_length/mean:331.46875 - response_length/max:2527.0 - response_length/min:43.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:331.46875 - response_length_non_aborted/max:2527.0 - response_length_non_aborted/min:43.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:105.6875 - prompt_length/max:184.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0004154592752456665 - timing_s/agent_loop/generate_sequences/min:4.600777488201857 - timing_s/agent_loop/generate_sequences/max:138.32071790099144 - timing_s/agent_loop/generate_sequences/mean:26.884507678372756 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:138.32071790099144 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:108 - timing_s/agent_loop/slowest/response_length:2527 - timing_s/gen:145.54302025213838 - timing_s/reward:0.0004090927541255951 - timing_s/old_log_prob:27.10947834700346 - timing_s/ref:22.43194554373622 - timing_s/adv:0.07311542704701424 - timing_s/update_actor:90.77455984428525 - timing_s/step:286.47507355362177 - timing_s/stop_profile:0.00015179067850112915 - timing_per_token_ms/update_actor:0.2027811133843673 - timing_per_token_ms/adv:0.00016333241083845841 - timing_per_token_ms/gen:0.4287941343338667 - timing_per_token_ms/ref:0.050110679694170907 - perf/total_num_tokens:447648 - perf/time_per_step:286.47507355362177 - perf/throughput:390.6517890431837
[36m(TaskRunner pid=34683)[0m step:2 - actor/entropy:0.49421192513545975 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:1.7360102901875507e-05 - actor/ppo_kl:-9.17887994811295e-06 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:3.7457321013789624e-06 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-2.1328204984349952e-06 - actor/grad_norm:0.1939377412199974 - perf/mfu/actor:0.013690739754556903 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.615234375 - perf/cpu_memory_used_gb:84.19220733642578 - actor/lr:5e-07 - training/global_step:2 - training/epoch:0 - critic/score/mean:0.0087890625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0087890625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0024106870405375957 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.35355237126350403 - critic/returns/mean:-0.0024106870405375957 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.35355237126350403 - response_length/mean:336.57421875 - response_length/max:3072.0 - response_length/min:14.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:336.57421875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:14.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:107.53125 - prompt_length/max:222.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00011916086077690125 - timing_s/agent_loop/generate_sequences/min:1.9148048162460327 - timing_s/agent_loop/generate_sequences/max:259.5138394832611 - timing_s/agent_loop/generate_sequences/mean:27.475095184920065 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:259.5138394832611 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:97 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:267.5186614319682 - timing_s/reward:0.0002872385084629059 - timing_s/old_log_prob:28.27027903497219 - timing_s/ref:23.981589931994677 - timing_s/adv:0.07363980636000633 - timing_s/update_actor:92.51205429062247 - timing_s/step:412.90827602148056 - timing_s/stop_profile:0.00012914836406707764 - timing_per_token_ms/update_actor:0.20342871091516143 - timing_per_token_ms/adv:0.0001619297181835113 - timing_per_token_ms/gen:0.7761993588662425 - timing_per_token_ms/ref:0.052734143274302 - perf/total_num_tokens:454764 - perf/time_per_step:412.90827602148056 - perf/throughput:275.34202291960236
[36m(TaskRunner pid=34683)[0m Training Progress:   7%|███████▏                                                                                                | 4/58 [19:53<4:16:13, 284.69s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:   9%|████████▉                                                                                               | 5/58 [28:41<5:28:59, 372.45s/it]
[36m(TaskRunner pid=34683)[0m step:3 - actor/entropy:0.5357821914949454 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:1.5197449101833627e-05 - actor/ppo_kl:9.362863335304894e-06 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:3.728530828084331e-06 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.3794293669988633e-05 - actor/grad_norm:0.1686057671904564 - perf/mfu/actor:0.014122942011613123 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:84.29592514038086 - actor/lr:5e-07 - training/global_step:3 - training/epoch:0 - critic/score/mean:0.005859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.005859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0017836315091699362 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.35355237126350403 - critic/returns/mean:-0.0017836315091699362 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.35355237126350403 - response_length/mean:352.88671875 - response_length/max:1567.0 - response_length/min:14.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:352.88671875 - response_length_non_aborted/max:1567.0 - response_length_non_aborted/min:14.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:105.34375 - prompt_length/max:201.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010469183325767517 - timing_s/agent_loop/generate_sequences/min:1.7391326688230038 - timing_s/agent_loop/generate_sequences/max:89.74977860599756 - timing_s/agent_loop/generate_sequences/mean:28.728194355688174 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:89.74977860599756 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:105 - timing_s/agent_loop/slowest/response_length:1567 - timing_s/gen:98.62730814144015 - timing_s/reward:0.0002651922404766083 - timing_s/old_log_prob:28.387163933366537 - timing_s/ref:23.679143872112036 - timing_s/adv:0.0747528225183487 - timing_s/update_actor:92.49918266013265 - timing_s/step:243.79599336907268 - timing_s/stop_profile:0.0001307278871536255 - timing_per_token_ms/update_actor:0.1971305690626575 - timing_per_token_ms/adv:0.0001593102340831082 - timing_per_token_ms/gen:0.2729366833301236 - timing_per_token_ms/ref:0.05046404705625418 - perf/total_num_tokens:469228 - perf/time_per_step:243.79599336907268 - perf/throughput:481.1686950999797
[36m(TaskRunner pid=34683)[0m step:4 - actor/entropy:0.4902597281616181 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:2.8585247946466552e-05 - actor/ppo_kl:1.9007369883583536e-07 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:4.698397788160946e-06 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.0951365940092828e-05 - actor/grad_norm:0.38414759933948517 - perf/mfu/actor:0.013511072127577135 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:84.43194961547852 - actor/lr:5e-07 - training/global_step:4 - training/epoch:0 - critic/score/mean:0.0185546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0185546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.004942845553159714 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.35355237126350403 - critic/returns/mean:-0.004942845553159714 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.35355237126350403 - response_length/mean:334.3798828125 - response_length/max:1733.0 - response_length/min:23.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:334.3798828125 - response_length_non_aborted/max:1733.0 - response_length_non_aborted/min:23.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:103.65625 - prompt_length/max:170.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010228157043457031 - timing_s/agent_loop/generate_sequences/min:2.627328161150217 - timing_s/agent_loop/generate_sequences/max:95.91856375336647 - timing_s/agent_loop/generate_sequences/mean:27.127957574986794 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:95.91856375336647 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:126 - timing_s/agent_loop/slowest/response_length:1733 - timing_s/gen:104.30441727489233 - timing_s/reward:0.00026474520564079285 - timing_s/old_log_prob:28.315236188471317 - timing_s/ref:23.595066122710705 - timing_s/adv:0.0739469863474369 - timing_s/update_actor:92.33511690795422 - timing_s/step:249.31608213484287 - timing_s/stop_profile:0.00012772157788276672 - timing_per_token_ms/update_actor:0.20585290995622377 - timing_per_token_ms/adv:0.00016485821247497353 - timing_per_token_ms/gen:0.30462293855198475 - timing_per_token_ms/ref:0.05260309603345611 - perf/total_num_tokens:448549 - perf/time_per_step:249.31608213484287 - perf/throughput:449.77944880166393
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 5}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m Training Progress:  10%|██████████▊                                                                                             | 6/58 [34:31<5:16:12, 364.85s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  12%|████████████▌                                                                                           | 7/58 [38:22<4:32:49, 320.98s/it]
[36m(TaskRunner pid=34683)[0m step:5 - actor/entropy:0.4848510158190038 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:2.6801752483152086e-05 - actor/ppo_kl:3.203751453373371e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:6.381142156897113e-06 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.4739742718059574e-06 - actor/grad_norm:0.2667192742228508 - perf/mfu/actor:0.013001974817138521 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:84.54617691040039 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.000758150113722517 - val-core/openai/gsm8k/acc/mean@1:0.000758150113722517 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:5 - training/epoch:0 - critic/score/mean:0.0146484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0146484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0027261553332209587 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.5400605201721191 - critic/returns/mean:-0.0027261553332209587 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.5400605201721191 - response_length/mean:319.171875 - response_length/max:1472.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:319.171875 - response_length_non_aborted/max:1472.0 - response_length_non_aborted/min:3.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:103.3984375 - prompt_length/max:177.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010384991765022278 - timing_s/agent_loop/generate_sequences/min:0.7477937527000904 - timing_s/agent_loop/generate_sequences/max:83.08424528688192 - timing_s/agent_loop/generate_sequences/mean:26.160387469157286 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:83.08424528688192 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:173 - timing_s/agent_loop/slowest/response_length:1472 - timing_s/gen:91.11343566328287 - timing_s/reward:0.000420253723859787 - timing_s/old_log_prob:28.462734192609787 - timing_s/ref:23.945521727204323 - timing_s/adv:0.08090606704354286 - timing_s/update_actor:92.44067806378007 - timing_s/step:236.5871877372265 - timing_s/testing:291.35309894382954 - timing_s/stop_profile:0.00013436004519462585 - timing_per_token_ms/update_actor:0.21363095560968975 - timing_per_token_ms/adv:0.00018697440108788956 - timing_per_token_ms/gen:0.27877758500784156 - timing_per_token_ms/ref:0.055338242820176756 - perf/total_num_tokens:432712 - perf/time_per_step:236.5871877372265 - perf/throughput:457.2436953777545
[36m(TaskRunner pid=34683)[0m step:6 - actor/entropy:0.5302226029452868 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.00013836813536727277 - actor/ppo_kl:-1.8907634216136504e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:1.6204510757233948e-05 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-2.51535306161621e-05 - actor/grad_norm:0.4673554003238678 - perf/mfu/actor:0.013187912668151856 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.21264362335205 - actor/lr:5e-07 - training/global_step:6 - training/epoch:0 - critic/score/mean:0.03515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.03515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.004952709190547466 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.935412585735321 - critic/returns/mean:-0.004952709190547466 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.935412585735321 - response_length/mean:324.3095703125 - response_length/max:3072.0 - response_length/min:4.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:324.3095703125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:4.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:104.0234375 - prompt_length/max:178.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00015201792120933533 - timing_s/agent_loop/generate_sequences/min:0.9720414988696575 - timing_s/agent_loop/generate_sequences/max:199.0151353366673 - timing_s/agent_loop/generate_sequences/mean:26.463370420278807 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:199.0151353366673 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:94 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:204.80934427678585 - timing_s/reward:0.00028639286756515503 - timing_s/old_log_prob:28.284163281321526 - timing_s/ref:23.787849687039852 - timing_s/adv:0.07298590987920761 - timing_s/update_actor:92.4386474750936 - timing_s/step:349.9571731053293 - timing_s/stop_profile:0.0001328587532043457 - timing_per_token_ms/update_actor:0.21075218353102532 - timing_per_token_ms/adv:0.00016640161116794898 - timing_per_token_ms/gen:0.6167228585871604 - timing_per_token_ms/ref:0.05423425590905845 - perf/total_num_tokens:438613 - perf/time_per_step:349.9571731053293 - perf/throughput:313.3333402684586
[36m(TaskRunner pid=34683)[0m Training Progress:  14%|██████████████▎                                                                                         | 8/58 [45:04<4:48:54, 346.68s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  16%|████████████████▏                                                                                       | 9/58 [49:43<4:25:49, 325.50s/it]
[36m(TaskRunner pid=34683)[0m step:7 - actor/entropy:0.5309884954767767 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0001206781686278191 - actor/ppo_kl:5.7290215507599385e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:2.5236920919269323e-05 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.071371817085165e-05 - actor/grad_norm:0.4477364718914032 - perf/mfu/actor:0.01292456152050031 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:84.90935134887695 - actor/lr:5e-07 - training/global_step:7 - training/epoch:0 - critic/score/mean:0.044921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.044921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.00871704239398241 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.7245674133300781 - critic/returns/mean:-0.00871704239398241 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.7245674133300781 - response_length/mean:316.21875 - response_length/max:1267.0 - response_length/min:14.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:316.21875 - response_length_non_aborted/max:1267.0 - response_length_non_aborted/min:14.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:103.03125 - prompt_length/max:215.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010492652654647827 - timing_s/agent_loop/generate_sequences/min:1.830259159207344 - timing_s/agent_loop/generate_sequences/max:77.19425531849265 - timing_s/agent_loop/generate_sequences/mean:25.818938131029427 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:77.19425531849265 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:133 - timing_s/agent_loop/slowest/response_length:1267 - timing_s/gen:85.29008387029171 - timing_s/reward:0.0004407167434692383 - timing_s/old_log_prob:28.50039778649807 - timing_s/ref:23.94411799684167 - timing_s/adv:0.07576435804367065 - timing_s/update_actor:92.17805026099086 - timing_s/step:230.5303403325379 - timing_s/stop_profile:0.00013325363397598267 - timing_per_token_ms/update_actor:0.2147110965008918 - timing_per_token_ms/adv:0.00017647854717238432 - timing_per_token_ms/gen:0.26339708676219153 - timing_per_token_ms/ref:0.055773232513513876 - perf/total_num_tokens:429312 - perf/time_per_step:230.5303403325379 - perf/throughput:465.5699542419464
[36m(TaskRunner pid=34683)[0m step:8 - actor/entropy:0.5275845222058706 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.00010019314470355312 - actor/ppo_kl:-4.461114421117074e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:4.1138933738693595e-05 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.6185887972142154e-05 - actor/grad_norm:0.5192084610462189 - perf/mfu/actor:0.013512605783467569 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.04897499084473 - actor/lr:5e-07 - training/global_step:8 - training/epoch:0 - critic/score/mean:0.0537109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0537109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.009706093929708004 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.7245674133300781 - critic/returns/mean:-0.009706093929708004 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.7245674133300781 - response_length/mean:331.06640625 - response_length/max:3072.0 - response_length/min:4.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:331.06640625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:4.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:106.9453125 - prompt_length/max:184.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010567903518676758 - timing_s/agent_loop/generate_sequences/min:0.9794053435325623 - timing_s/agent_loop/generate_sequences/max:248.42694127187133 - timing_s/agent_loop/generate_sequences/mean:26.879595266804245 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:248.42694127187133 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:157 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:256.37545735761523 - timing_s/reward:0.00035469233989715576 - timing_s/old_log_prob:28.166905719786882 - timing_s/ref:23.904806677252054 - timing_s/adv:0.07403364032506943 - timing_s/update_actor:92.5384441204369 - timing_s/step:401.6017117574811 - timing_s/stop_profile:0.00013347342610359192 - timing_per_token_ms/update_actor:0.20631770901988947 - timing_per_token_ms/adv:0.00016506059948869943 - timing_per_token_ms/gen:0.7562430160513941 - timing_per_token_ms/ref:0.053296605482096956 - perf/total_num_tokens:448524 - perf/time_per_step:401.6017117574811 - perf/throughput:279.20946728362946
[36m(TaskRunner pid=34683)[0m step:9 - actor/entropy:0.5780999385460746 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.00011618379517130961 - actor/ppo_kl:-5.733055616019556e-06 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:5.973779479973018e-05 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:6.67898899608943e-06 - actor/grad_norm:0.5220154225826263 - perf/mfu/actor:0.013319088511744891 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.01825332641602 - actor/lr:5e-07 - training/global_step:9 - training/epoch:0 - critic/score/mean:0.0576171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0576171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.011570215225219727 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.7245674133300781 - critic/returns/mean:-0.011570215225219727 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.7245674133300781 - response_length/mean:324.07421875 - response_length/max:2385.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:324.07421875 - response_length_non_aborted/max:2385.0 - response_length_non_aborted/min:3.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:105.4453125 - prompt_length/max:256.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00014413148164749146 - timing_s/agent_loop/generate_sequences/min:0.7697938419878483 - timing_s/agent_loop/generate_sequences/max:126.1086153909564 - timing_s/agent_loop/generate_sequences/mean:26.13555198054746 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:126.1086153909564 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:114 - timing_s/agent_loop/slowest/response_length:2385 - timing_s/gen:134.25333569571376 - timing_s/reward:0.0002690441906452179 - timing_s/old_log_prob:28.308368176221848 - timing_s/ref:23.65648689866066 - timing_s/adv:0.07327140122652054 - timing_s/update_actor:91.94966548681259 - timing_s/step:278.78143187239766 - timing_s/stop_profile:0.0001332201063632965 - timing_per_token_ms/update_actor:0.2090582352347113 - timing_per_token_ms/adv:0.0001665910338280431 - timing_per_token_ms/gen:0.4045578622268775 - timing_per_token_ms/ref:0.05378576829729044 - perf/total_num_tokens:439828 - perf/time_per_step:278.78143187239766 - perf/throughput:394.42009914895954
[36m(TaskRunner pid=34683)[0m Training Progress:  17%|█████████████████▊                                                                                     | 10/58 [58:52<5:15:38, 394.55s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  19%|███████████████████▏                                                                                 | 11/58 [1:05:53<5:15:28, 402.74s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  21%|████████████████████▉                                                                                | 12/58 [1:12:39<5:09:27, 403.63s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:10 - actor/entropy:0.5363543060666416 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.00044027093372278614 - actor/ppo_kl:0.00010729384987140378 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:9.379727998748422e-05 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-5.276545298471547e-06 - actor/grad_norm:0.5437844693660736 - perf/mfu/actor:0.012304345548397773 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.14132308959961 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.08188021228203184 - val-core/openai/gsm8k/acc/mean@1:0.08188021228203184 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:10 - training/epoch:0 - critic/score/mean:0.076171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.076171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02112598344683647 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.935412585735321 - critic/returns/mean:-0.02112598344683647 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.935412585735321 - response_length/mean:300.1748046875 - response_length/max:1957.0 - response_length/min:4.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:300.1748046875 - response_length_non_aborted/max:1957.0 - response_length_non_aborted/min:4.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:99.078125 - prompt_length/max:161.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0001024790108203888 - timing_s/agent_loop/generate_sequences/min:0.6830220334231853 - timing_s/agent_loop/generate_sequences/max:106.14983109012246 - timing_s/agent_loop/generate_sequences/mean:24.304792554878077 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:106.14983109012246 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:96 - timing_s/agent_loop/slowest/response_length:1957 - timing_s/gen:114.240708373487 - timing_s/reward:0.00029511377215385437 - timing_s/old_log_prob:28.472728602588177 - timing_s/ref:23.65103990584612 - timing_s/adv:0.07217810675501823 - timing_s/update_actor:92.22306324541569 - timing_s/step:259.1843642294407 - timing_s/testing:289.85808131843805 - timing_s/stop_profile:0.00013886019587516785 - timing_per_token_ms/update_actor:0.22557526445978374 - timing_per_token_ms/adv:0.00017654581128087916 - timing_per_token_ms/gen:0.37166074576821123 - timing_per_token_ms/ref:0.05784984139285071 - perf/total_num_tokens:408835 - perf/time_per_step:259.1843642294407 - perf/throughput:394.3476694817925
[36m(TaskRunner pid=34683)[0m step:11 - actor/entropy:0.6078115182172041 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.00048778990992559557 - actor/ppo_kl:0.00011077764541328472 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00016809161752462387 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.7033923797326054e-06 - actor/grad_norm:0.6903638243675232 - perf/mfu/actor:0.013090454089133202 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.18416213989258 - actor/lr:5e-07 - training/global_step:11 - training/epoch:0 - critic/score/mean:0.09765625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.09765625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.023123275488615036 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-1.20761239528656 - critic/returns/mean:-0.023123275488615036 - critic/returns/max:2.4748666286468506 - critic/returns/min:-1.20761239528656 - response_length/mean:320.6875 - response_length/max:3072.0 - response_length/min:5.0 - response_length/clip_ratio:0.0048828125 - response_length_non_aborted/mean:320.6875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:5.0 - response_length_non_aborted/clip_ratio:0.0048828125 - response/aborted_ratio:0.0 - prompt_length/mean:100.9453125 - prompt_length/max:156.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010579079389572144 - timing_s/agent_loop/generate_sequences/min:0.814037274569273 - timing_s/agent_loop/generate_sequences/max:269.44077372550964 - timing_s/agent_loop/generate_sequences/mean:25.547195619132253 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:269.44077372550964 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:97 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:275.7256800569594 - timing_s/reward:0.0005526840686798096 - timing_s/old_log_prob:28.521414153277874 - timing_s/ref:23.72663141041994 - timing_s/adv:0.11078919470310211 - timing_s/update_actor:92.39293611422181 - timing_s/step:421.18987315520644 - timing_s/stop_profile:0.00014740973711013794 - timing_per_token_ms/update_actor:0.21399538650480324 - timing_per_token_ms/adv:0.0002566037787968605 - timing_per_token_ms/gen:0.8396440754024538 - timing_per_token_ms/ref:0.054954305736672766 - perf/total_num_tokens:431752 - perf/time_per_step:421.18987315520644 - perf/throughput:256.2692193699191
[36m(TaskRunner pid=34683)[0m Training Progress:  22%|██████████████████████▋                                                                              | 13/58 [1:17:20<4:34:51, 366.48s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  24%|████████████████████████▍                                                                            | 14/58 [1:24:13<4:39:12, 380.74s/it]
[36m(TaskRunner pid=34683)[0m step:12 - actor/entropy:0.6485252373386174 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.00036288319523691825 - actor/ppo_kl:0.00027667405659315136 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0002127988263964653 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.1578662059873466e-05 - actor/grad_norm:0.9346351325511932 - perf/mfu/actor:0.013546013400944967 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.33932876586914 - actor/lr:5e-07 - training/global_step:12 - training/epoch:0 - critic/score/mean:0.083984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.083984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0325591042637825 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.935412585735321 - critic/returns/mean:-0.0325591042637825 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.935412585735321 - response_length/mean:330.0146484375 - response_length/max:3072.0 - response_length/min:5.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:330.0146484375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:5.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:107.109375 - prompt_length/max:177.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0001073107123374939 - timing_s/agent_loop/generate_sequences/min:1.0006415508687496 - timing_s/agent_loop/generate_sequences/max:252.5391087345779 - timing_s/agent_loop/generate_sequences/mean:25.976624165188696 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:252.5391087345779 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:108 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:260.4805459268391 - timing_s/reward:0.00029112398624420166 - timing_s/old_log_prob:28.34539020806551 - timing_s/ref:23.564519736915827 - timing_s/adv:0.08423565328121185 - timing_s/update_actor:92.49262537434697 - timing_s/step:405.5288677252829 - timing_s/stop_profile:0.00012969225645065308 - timing_per_token_ms/update_actor:0.20663432944460525 - timing_per_token_ms/adv:0.00018818773562372096 - timing_per_token_ms/gen:0.7708007336524453 - timing_per_token_ms/ref:0.05264461587953001 - perf/total_num_tokens:447615 - perf/time_per_step:405.5288677252829 - perf/throughput:275.94521353731807
[36m(TaskRunner pid=34683)[0m step:13 - actor/entropy:0.6398678675177507 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0003752053504513242 - actor/ppo_kl:0.0002031740818360106 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00023041944950819016 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.340015152040408e-05 - actor/grad_norm:0.7516041100025177 - perf/mfu/actor:0.013132929015634473 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.32508087158203 - actor/lr:5e-07 - training/global_step:13 - training/epoch:0 - critic/score/mean:0.0908203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0908203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.021487411111593246 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-1.6201815605163574 - critic/returns/mean:-0.021487411111593246 - critic/returns/max:2.4748666286468506 - critic/returns/min:-1.6201815605163574 - response_length/mean:318.7529296875 - response_length/max:2280.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:318.7529296875 - response_length_non_aborted/max:2280.0 - response_length_non_aborted/min:5.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:106.1484375 - prompt_length/max:211.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010330229997634888 - timing_s/agent_loop/generate_sequences/min:0.9799254275858402 - timing_s/agent_loop/generate_sequences/max:127.98949674516916 - timing_s/agent_loop/generate_sequences/mean:25.445294670364092 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:127.98949674516916 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:98 - timing_s/agent_loop/slowest/response_length:2280 - timing_s/gen:136.13048192113638 - timing_s/reward:0.0003415010869503021 - timing_s/old_log_prob:28.35952777788043 - timing_s/ref:23.512503311038017 - timing_s/adv:0.07422185689210892 - timing_s/update_actor:92.13721415027976 - timing_s/step:280.83058827742934 - timing_s/stop_profile:0.00013406574726104736 - timing_per_token_ms/update_actor:0.2117614937066731 - timing_per_token_ms/adv:0.0001705861353211773 - timing_per_token_ms/gen:0.41706259415855973 - timing_per_token_ms/ref:0.05403943311990608 - perf/total_num_tokens:435099 - perf/time_per_step:280.83058827742934 - perf/throughput:387.3322726958171
[36m(TaskRunner pid=34683)[0m step:14 - actor/entropy:0.6601996792014688 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0002891971415124317 - actor/ppo_kl:0.00012799694861342914 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00021192128770053387 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.654989851575863e-05 - actor/grad_norm:0.6432821750640869 - perf/mfu/actor:0.013680219617025032 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.56720733642578 - actor/lr:5e-07 - training/global_step:14 - training/epoch:0 - critic/score/mean:0.119140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.119140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03170804679393768 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-1.20761239528656 - critic/returns/mean:-0.03170804679393768 - critic/returns/max:2.4748666286468506 - critic/returns/min:-1.20761239528656 - response_length/mean:335.2001953125 - response_length/max:3072.0 - response_length/min:7.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:335.2001953125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:7.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:106.234375 - prompt_length/max:199.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00014277920126914978 - timing_s/agent_loop/generate_sequences/min:1.20501010119915 - timing_s/agent_loop/generate_sequences/max:259.24259907752275 - timing_s/agent_loop/generate_sequences/mean:27.071686341700115 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:259.24259907752275 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:96 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:267.1627789027989 - timing_s/reward:0.00025061890482902527 - timing_s/old_log_prob:28.350093435496092 - timing_s/ref:25.2039154805243 - timing_s/adv:0.07638127729296684 - timing_s/update_actor:92.19825638085604 - timing_s/step:413.55189280584455 - timing_s/stop_profile:0.00012514740228652954 - timing_per_token_ms/update_actor:0.20396535704757005 - timing_per_token_ms/adv:0.0001689742854838226 - timing_per_token_ms/gen:0.7783442698445684 - timing_per_token_ms/ref:0.05575729760817182 - perf/total_num_tokens:452029 - perf/time_per_step:413.55189280584455 - perf/throughput:273.2601445329497
[36m(TaskRunner pid=34683)[0m Training Progress:  26%|██████████████████████████                                                                           | 15/58 [1:35:15<5:33:35, 465.47s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  28%|███████████████████████████▊                                                                         | 16/58 [1:42:18<5:16:43, 452.46s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  29%|█████████████████████████████▌                                                                       | 17/58 [1:47:14<4:37:08, 405.58s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 15}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:15 - actor/entropy:0.6126101647387259 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.00027325320752424886 - actor/ppo_kl:6.04480692327769e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0002232890110462904 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.8034783765052964e-05 - actor/grad_norm:0.6450247466564178 - perf/mfu/actor:0.012903521615480019 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.30387878417969 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.22365428354814254 - val-core/openai/gsm8k/acc/mean@1:0.22365428354814254 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:15 - training/epoch:0 - critic/score/mean:0.1455078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1455078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03627444803714752 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-1.6201815605163574 - critic/returns/mean:-0.03627444803714752 - critic/returns/max:2.4748666286468506 - critic/returns/min:-1.6201815605163574 - response_length/mean:315.830078125 - response_length/max:3072.0 - response_length/min:5.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:315.830078125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:5.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:103.4140625 - prompt_length/max:168.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010835006833076477 - timing_s/agent_loop/generate_sequences/min:0.9361231811344624 - timing_s/agent_loop/generate_sequences/max:214.28032405674458 - timing_s/agent_loop/generate_sequences/mean:25.464630072234286 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:214.28032405674458 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:109 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:222.5781219676137 - timing_s/reward:0.000539872795343399 - timing_s/old_log_prob:28.589041616767645 - timing_s/ref:23.62762702256441 - timing_s/adv:0.09410301968455315 - timing_s/update_actor:92.64629769325256 - timing_s/step:368.1727220900357 - timing_s/testing:293.5017247982323 - timing_s/stop_profile:0.00016244128346443176 - timing_per_token_ms/update_actor:0.2158048051815082 - timing_per_token_ms/adv:0.00021919800721292772 - timing_per_token_ms/gen:0.6882227573903519 - timing_per_token_ms/ref:0.0550367966498591 - perf/total_num_tokens:429306 - perf/time_per_step:368.1727220900357 - perf/throughput:291.5112759868005
[36m(TaskRunner pid=34683)[0m step:16 - actor/entropy:0.5960292643285356 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.00045477705657503975 - actor/ppo_kl:-6.7038290101351095e-06 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00024172943085432053 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-8.422777804106829e-06 - actor/grad_norm:0.6147044897079468 - perf/mfu/actor:0.013846661301474274 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.85121154785156 - actor/lr:5e-07 - training/global_step:16 - training/epoch:0 - critic/score/mean:0.15625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.15625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03701532259583473 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-1.6201815605163574 - critic/returns/mean:-0.03701532259583473 - critic/returns/max:2.4748666286468506 - critic/returns/min:-1.6201815605163574 - response_length/mean:344.1591796875 - response_length/max:3072.0 - response_length/min:55.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:344.1591796875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:55.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:102.515625 - prompt_length/max:167.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010431930422782898 - timing_s/agent_loop/generate_sequences/min:5.293881967663765 - timing_s/agent_loop/generate_sequences/max:271.4346200376749 - timing_s/agent_loop/generate_sequences/mean:27.814996262051864 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:271.4346200376749 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:104 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:277.1251337751746 - timing_s/reward:0.000321902334690094 - timing_s/old_log_prob:28.2587334997952 - timing_s/ref:23.537122789770365 - timing_s/adv:0.08978290483355522 - timing_s/update_actor:92.39251312240958 - timing_s/step:422.0602957047522 - timing_s/stop_profile:0.00016066059470176697 - timing_per_token_ms/update_actor:0.20199720837002938 - timing_per_token_ms/adv:0.00019629183710699773 - timing_per_token_ms/gen:0.7863512857569388 - timing_per_token_ms/ref:0.05145907320755663 - perf/total_num_tokens:457395 - perf/time_per_step:422.0602957047522 - perf/throughput:270.92989121154255
[36m(TaskRunner pid=34683)[0m Training Progress:  31%|███████████████████████████████▎                                                                     | 18/58 [1:54:13<4:33:08, 409.72s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  33%|█████████████████████████████████                                                                    | 19/58 [1:58:45<3:59:16, 368.10s/it]
[36m(TaskRunner pid=34683)[0m step:17 - actor/entropy:0.5937467016046867 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.00041264153310294205 - actor/ppo_kl:1.5031168875800915e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00026678387075662613 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:6.0250378572490604e-05 - actor/grad_norm:0.6733689904212952 - perf/mfu/actor:0.013230136426421632 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.3967514038086 - actor/lr:5e-07 - training/global_step:17 - training/epoch:0 - critic/score/mean:0.19140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.19140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04963421821594238 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-1.6201815605163574 - critic/returns/mean:-0.04963421821594238 - critic/returns/max:2.4748666286468506 - critic/returns/min:-1.6201815605163574 - response_length/mean:323.314453125 - response_length/max:2521.0 - response_length/min:11.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:323.314453125 - response_length_non_aborted/max:2521.0 - response_length_non_aborted/min:11.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:104.3203125 - prompt_length/max:172.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00017600879073143005 - timing_s/agent_loop/generate_sequences/min:1.5452029183506966 - timing_s/agent_loop/generate_sequences/max:143.3683732189238 - timing_s/agent_loop/generate_sequences/mean:25.91668412559011 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:143.3683732189238 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:120 - timing_s/agent_loop/slowest/response_length:2521 - timing_s/gen:151.52423906698823 - timing_s/reward:0.00027929991483688354 - timing_s/old_log_prob:28.322350095957518 - timing_s/ref:23.677670404314995 - timing_s/adv:0.0789702907204628 - timing_s/update_actor:92.09525619447231 - timing_s/step:296.3484523668885 - timing_s/stop_profile:0.00013431161642074585 - timing_per_token_ms/update_actor:0.21031211879129916 - timing_per_token_ms/adv:0.00018033946425985686 - timing_per_token_ms/gen:0.4576748372478305 - timing_per_token_ms/ref:0.05407120015235282 - perf/total_num_tokens:437898 - perf/time_per_step:296.3484523668885 - perf/throughput:369.4114112142121
[36m(TaskRunner pid=34683)[0m step:18 - actor/entropy:0.5816831032570917 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.000498260615813706 - actor/ppo_kl:-2.9462517959544243e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003023790195584297 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:7.114457232226812e-06 - actor/grad_norm:0.7154728174209595 - perf/mfu/actor:0.01308271014143723 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.62077522277832 - actor/lr:5e-07 - training/global_step:18 - training/epoch:0 - critic/score/mean:0.2421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.2421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06613054871559143 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06613054871559143 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:319.3828125 - response_length/max:3072.0 - response_length/min:13.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:319.3828125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:13.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:104.2578125 - prompt_length/max:168.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00011116266250610352 - timing_s/agent_loop/generate_sequences/min:1.6009287424385548 - timing_s/agent_loop/generate_sequences/max:265.3378360904753 - timing_s/agent_loop/generate_sequences/mean:25.463650399295148 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:265.3378360904753 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:88 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:274.1171506792307 - timing_s/reward:0.0006079636514186859 - timing_s/old_log_prob:28.42249048128724 - timing_s/ref:23.51340112835169 - timing_s/adv:0.08436394482851028 - timing_s/update_actor:92.49093369394541 - timing_s/step:419.21907190606 - timing_s/stop_profile:0.00013135001063346863 - timing_per_token_ms/update_actor:0.21320707246972256 - timing_per_token_ms/adv:0.00019447300379087128 - timing_per_token_ms/gen:0.838155716222789 - timing_per_token_ms/ref:0.05420232252137279 - perf/total_num_tokens:433808 - perf/time_per_step:419.21907190606 - perf/throughput:258.700062253614
[36m(TaskRunner pid=34683)[0m step:19 - actor/entropy:0.5977681212243624 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0005245583120085939 - actor/ppo_kl:5.725725817851135e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00030988967046141624 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.008738857301907e-05 - actor/grad_norm:0.6512408554553986 - perf/mfu/actor:0.013167136630463988 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.3492431640625 - actor/lr:5e-07 - training/global_step:19 - training/epoch:0 - critic/score/mean:0.22265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.22265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04596230387687683 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04596230387687683 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:322.2197265625 - response_length/max:2074.0 - response_length/min:37.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:322.2197265625 - response_length_non_aborted/max:2074.0 - response_length_non_aborted/min:37.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:105.1171875 - prompt_length/max:173.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010875239968299866 - timing_s/agent_loop/generate_sequences/min:3.9278269931674004 - timing_s/agent_loop/generate_sequences/max:117.40990485623479 - timing_s/agent_loop/generate_sequences/mean:25.94518555767354 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:117.40990485623479 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:140 - timing_s/agent_loop/slowest/response_length:2074 - timing_s/gen:125.70978273078799 - timing_s/reward:0.0003369040787220001 - timing_s/old_log_prob:28.201804805547 - timing_s/ref:23.987075943499804 - timing_s/adv:0.07748221978545189 - timing_s/update_actor:92.38931233808398 - timing_s/step:271.04627477005124 - timing_s/stop_profile:0.00013080239295959473 - timing_per_token_ms/update_actor:0.21113069070593904 - timing_per_token_ms/adv:0.00017706457778221289 - timing_per_token_ms/gen:0.3809929981869781 - timing_per_token_ms/ref:0.054815949851802485 - perf/total_num_tokens:437593 - perf/time_per_step:271.04627477005124 - perf/throughput:403.6146598687279
[36m(TaskRunner pid=34683)[0m Training Progress:  34%|██████████████████████████████████▊                                                                  | 20/58 [2:10:39<4:58:53, 471.94s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  36%|████████████████████████████████████▌                                                                | 21/58 [2:17:43<4:42:10, 457.59s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  38%|██████████████████████████████████████▎                                                              | 22/58 [2:24:52<4:29:28, 449.13s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 20}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:20 - actor/entropy:0.6022839106735773 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006481946067822264 - actor/ppo_kl:-6.571141981215334e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00037120841443538666 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:9.526768820045106e-06 - actor/grad_norm:0.7118407785892487 - perf/mfu/actor:0.013028595819330909 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.355149269104 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.3593631539044731 - val-core/openai/gsm8k/acc/mean@1:0.3593631539044731 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:20 - training/epoch:0 - critic/score/mean:0.2646484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.2646484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04056868702173233 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04056868702173233 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:319.0185546875 - response_length/max:3072.0 - response_length/min:42.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:319.0185546875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:42.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:103.9375 - prompt_length/max:196.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010317191481590271 - timing_s/agent_loop/generate_sequences/min:4.169737912714481 - timing_s/agent_loop/generate_sequences/max:269.08887861296535 - timing_s/agent_loop/generate_sequences/mean:25.413069093119702 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:269.08887861296535 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:112 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:277.44589933753014 - timing_s/reward:0.00042121484875679016 - timing_s/old_log_prob:28.29169473052025 - timing_s/ref:23.646531336009502 - timing_s/adv:0.093464195728302 - timing_s/update_actor:92.85338232666254 - timing_s/step:423.04265988245606 - timing_s/testing:290.75188751518726 - timing_s/stop_profile:0.000158749520778656 - timing_per_token_ms/update_actor:0.21438901316917652 - timing_per_token_ms/adv:0.00021579931917124867 - timing_per_token_ms/gen:0.8493025157649962 - timing_per_token_ms/ref:0.054597435128061894 - perf/total_num_tokens:433107 - perf/time_per_step:423.04265988245606 - perf/throughput:255.94759173953068
[36m(TaskRunner pid=34683)[0m step:21 - actor/entropy:0.5267829867370892 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0007128730980525688 - actor/ppo_kl:-0.0001237396596600604 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00041931401938199997 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-9.761744052205756e-06 - actor/grad_norm:0.7488596141338348 - perf/mfu/actor:0.012895522592709329 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.94124031066895 - actor/lr:5e-07 - training/global_step:21 - training/epoch:0 - critic/score/mean:0.2783203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.2783203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05555624142289162 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05555624142289162 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:311.6552734375 - response_length/max:3072.0 - response_length/min:17.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:311.6552734375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:17.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:104.515625 - prompt_length/max:181.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010523945093154907 - timing_s/agent_loop/generate_sequences/min:2.0804882645606995 - timing_s/agent_loop/generate_sequences/max:272.2423797957599 - timing_s/agent_loop/generate_sequences/mean:25.033698018814903 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:272.2423797957599 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:110 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:278.5247529037297 - timing_s/reward:0.00026670098304748535 - timing_s/old_log_prob:28.504010505974293 - timing_s/ref:23.973291143774986 - timing_s/adv:0.08106445893645287 - timing_s/update_actor:92.2641111575067 - timing_s/step:424.0061115771532 - timing_s/stop_profile:0.00012706220149993896 - timing_per_token_ms/update_actor:0.21650161361723372 - timing_per_token_ms/adv:0.00019022115908957189 - timing_per_token_ms/gen:0.8727490024714609 - timing_per_token_ms/ref:0.05625433498711745 - perf/total_num_tokens:426159 - perf/time_per_step:424.0061115771532 - perf/throughput:251.2693734618817
[36m(TaskRunner pid=34683)[0m Training Progress:  40%|████████████████████████████████████████                                                             | 23/58 [2:31:56<4:17:34, 441.57s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  41%|█████████████████████████████████████████▊                                                           | 24/58 [2:38:54<4:06:13, 434.53s/it]
[36m(TaskRunner pid=34683)[0m step:22 - actor/entropy:0.5941766943142284 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.000544095763501673 - actor/ppo_kl:-5.019319238463993e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00043956562876701355 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.0516846481678499e-05 - actor/grad_norm:0.7653017640113831 - perf/mfu/actor:0.01325464117153003 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.86062622070312 - actor/lr:5e-07 - training/global_step:22 - training/epoch:0 - critic/score/mean:0.255859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.255859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0488642081618309 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0488642081618309 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:322.9619140625 - response_length/max:3072.0 - response_length/min:49.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:322.9619140625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:49.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:103.75 - prompt_length/max:206.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0001579485833644867 - timing_s/agent_loop/generate_sequences/min:5.043743208050728 - timing_s/agent_loop/generate_sequences/max:275.83203832805157 - timing_s/agent_loop/generate_sequences/mean:25.728831586875458 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:275.83203832805157 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:78 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:283.98847675696015 - timing_s/reward:0.0002937912940979004 - timing_s/old_log_prob:28.49263920262456 - timing_s/ref:23.732490945607424 - timing_s/adv:0.09389175474643707 - timing_s/update_actor:92.32571510598063 - timing_s/step:429.23130514100194 - timing_s/stop_profile:0.00013097375631332397 - timing_per_token_ms/update_actor:0.21129438430673467 - timing_per_token_ms/adv:0.00021487838450917393 - timing_per_token_ms/gen:0.8587157951364481 - timing_per_token_ms/ref:0.05431360110951847 - perf/total_num_tokens:436953 - perf/time_per_step:429.23130514100194 - perf/throughput:254.49739730450315
[36m(TaskRunner pid=34683)[0m step:23 - actor/entropy:0.49108821840491146 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006249080324778333 - actor/ppo_kl:8.576302157869975e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0005095000378787518 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-2.833623505527072e-05 - actor/grad_norm:0.8559331595897675 - perf/mfu/actor:0.012022122622572046 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.82590866088867 - actor/lr:5e-07 - training/global_step:23 - training/epoch:0 - critic/score/mean:0.3203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06424466520547867 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06424466520547867 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:288.2939453125 - response_length/max:3072.0 - response_length/min:3.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:288.2939453125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:3.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:102.0703125 - prompt_length/max:201.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010569021105766296 - timing_s/agent_loop/generate_sequences/min:0.8878084793686867 - timing_s/agent_loop/generate_sequences/max:269.70091201737523 - timing_s/agent_loop/generate_sequences/mean:23.30186845600474 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:269.70091201737523 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:79 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:278.19378189370036 - timing_s/reward:0.00031693652272224426 - timing_s/old_log_prob:28.417952120304108 - timing_s/ref:23.877527326345444 - timing_s/adv:0.09160565957427025 - timing_s/update_actor:92.5378901027143 - timing_s/step:423.7368309684098 - timing_s/stop_profile:0.00012803450226783752 - timing_per_token_ms/update_actor:0.2314992510068328 - timing_per_token_ms/adv:0.0002291671179869319 - timing_per_token_ms/gen:0.9423493609485367 - timing_per_token_ms/ref:0.05973369055430861 - perf/total_num_tokens:399733 - perf/time_per_step:423.7368309684098 - perf/throughput:235.83800768890484
[36m(TaskRunner pid=34683)[0m step:24 - actor/entropy:0.47159529430791736 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0007410905881215513 - actor/ppo_kl:6.625666285664522e-05 - actor/pg_clipfrac_lower:2.8347242277959595e-06 - actor/kl_loss:0.0005872007459402084 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:5.451342889895017e-05 - actor/grad_norm:0.8181696832180023 - perf/mfu/actor:0.011695572745296336 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.56560897827148 - actor/lr:5e-07 - training/global_step:24 - training/epoch:0 - critic/score/mean:0.3701171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3701171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07906199246644974 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07906199246644974 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:278.4375 - response_length/max:3072.0 - response_length/min:18.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:278.4375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:18.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:99.9453125 - prompt_length/max:168.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0001234486699104309 - timing_s/agent_loop/generate_sequences/min:2.263580273836851 - timing_s/agent_loop/generate_sequences/max:264.65218710526824 - timing_s/agent_loop/generate_sequences/mean:22.327946979847184 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:264.65218710526824 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:87 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:272.93178533390164 - timing_s/reward:0.00031762197613716125 - timing_s/old_log_prob:28.38153036683798 - timing_s/ref:23.7092081643641 - timing_s/adv:0.0970308929681778 - timing_s/update_actor:92.13847025483847 - timing_s/step:417.8899179175496 - timing_s/stop_profile:0.0001370646059513092 - timing_per_token_ms/update_actor:0.23779878970649782 - timing_per_token_ms/adv:0.0002504255697772639 - timing_per_token_ms/gen:0.9572523335223823 - timing_per_token_ms/ref:0.061190738144354315 - perf/total_num_tokens:387464 - perf/time_per_step:417.8899179175496 - perf/throughput:231.79788706726308
[36m(TaskRunner pid=34683)[0m Training Progress:  43%|███████████████████████████████████████████▌                                                         | 25/58 [2:50:30<4:42:07, 512.96s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  45%|█████████████████████████████████████████████▎                                                       | 26/58 [2:57:17<4:16:39, 481.25s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  47%|███████████████████████████████████████████████                                                      | 27/58 [3:02:22<3:41:15, 428.23s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 25}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:25 - actor/entropy:0.49603053866303526 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006405168176684128 - actor/ppo_kl:-3.231181950802409e-05 - actor/pg_clipfrac_lower:3.741618684216519e-06 - actor/kl_loss:0.0005651786923408508 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.168161424658365e-05 - actor/grad_norm:0.8333760797977448 - perf/mfu/actor:0.012049020401346429 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.81872177124023 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.4071266110689917 - val-core/openai/gsm8k/acc/mean@1:0.4071266110689917 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:25 - training/epoch:0 - critic/score/mean:0.333984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.333984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07251132279634476 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07251132279634476 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:287.7939453125 - response_length/max:3072.0 - response_length/min:37.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:287.7939453125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:37.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:101.6875 - prompt_length/max:171.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0001712404191493988 - timing_s/agent_loop/generate_sequences/min:3.9288732558488846 - timing_s/agent_loop/generate_sequences/max:256.4112790003419 - timing_s/agent_loop/generate_sequences/mean:23.130477361359226 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:256.4112790003419 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:84 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:264.70928674936295 - timing_s/reward:0.0003018490970134735 - timing_s/old_log_prob:28.365037713199854 - timing_s/ref:23.74816368892789 - timing_s/adv:0.08392399176955223 - timing_s/update_actor:92.20059267804027 - timing_s/step:409.7131238132715 - timing_s/testing:286.0377941802144 - timing_s/stop_profile:0.00013718754053115845 - timing_per_token_ms/update_actor:0.23117825603965675 - timing_per_token_ms/adv:0.00021042600154339887 - timing_per_token_ms/gen:0.8982300255152271 - timing_per_token_ms/ref:0.059544726408881726 - perf/total_num_tokens:398829 - perf/time_per_step:409.7131238132715 - perf/throughput:243.35869222837488
[36m(TaskRunner pid=34683)[0m step:26 - actor/entropy:0.47074422574951313 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006356726185003936 - actor/ppo_kl:-7.328957173236006e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0005269218236207962 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.780849545784946e-05 - actor/grad_norm:0.7761246263980865 - perf/mfu/actor:0.012470294799581859 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.24524688720703 - actor/lr:5e-07 - training/global_step:26 - training/epoch:0 - critic/score/mean:0.3505859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3505859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04945234954357147 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04945234954357147 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:298.7314453125 - response_length/max:3072.0 - response_length/min:20.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:298.7314453125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:20.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:106.4375 - prompt_length/max:170.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00012372061610221863 - timing_s/agent_loop/generate_sequences/min:2.3249764665961266 - timing_s/agent_loop/generate_sequences/max:256.3820275440812 - timing_s/agent_loop/generate_sequences/mean:24.095094585707557 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:256.3820275440812 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:80 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:261.99088967964053 - timing_s/reward:0.0002398379147052765 - timing_s/old_log_prob:28.30745606124401 - timing_s/ref:23.59605696797371 - timing_s/adv:0.07218850404024124 - timing_s/update_actor:92.59218446537852 - timing_s/step:407.12144531309605 - timing_s/stop_profile:0.00014834105968475342 - timing_per_token_ms/update_actor:0.22317123804300995 - timing_per_token_ms/adv:0.00017399306336872699 - timing_per_token_ms/gen:0.8564564668949776 - timing_per_token_ms/ref:0.056872632143645976 - perf/total_num_tokens:414893 - perf/time_per_step:407.12144531309605 - perf/throughput:254.77225823913994
[36m(TaskRunner pid=34683)[0m Training Progress:  48%|████████████████████████████████████████████████▊                                                    | 28/58 [3:08:59<3:29:23, 418.78s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  50%|██████████████████████████████████████████████████▌                                                  | 29/58 [3:16:02<3:23:03, 420.10s/it]
[36m(TaskRunner pid=34683)[0m step:27 - actor/entropy:0.4498930651752744 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006985876193539298 - actor/ppo_kl:0.00010092305970070548 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0006099911406636238 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.019117763252254e-05 - actor/grad_norm:0.8142887949943542 - perf/mfu/actor:0.011705872614130856 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:85.84645080566406 - actor/lr:5e-07 - training/global_step:27 - training/epoch:0 - critic/score/mean:0.3798828125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3798828125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06884969025850296 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06884969025850296 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:277.056640625 - response_length/max:2902.0 - response_length/min:6.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:277.056640625 - response_length_non_aborted/max:2902.0 - response_length_non_aborted/min:6.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:103.46875 - prompt_length/max:178.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010330602526664734 - timing_s/agent_loop/generate_sequences/min:1.0705038234591484 - timing_s/agent_loop/generate_sequences/max:151.25832003355026 - timing_s/agent_loop/generate_sequences/mean:21.995235663860512 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:151.25832003355026 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:82 - timing_s/agent_loop/slowest/response_length:2761 - timing_s/gen:159.27713442221284 - timing_s/reward:0.0002589300274848938 - timing_s/old_log_prob:28.351482316851616 - timing_s/ref:23.62981003150344 - timing_s/adv:0.07351655140519142 - timing_s/update_actor:92.52319626510143 - timing_s/step:304.4103294759989 - timing_s/stop_profile:0.00013085827231407166 - timing_per_token_ms/update_actor:0.23744718770075665 - timing_per_token_ms/adv:0.0001886694265360686 - timing_per_token_ms/gen:0.5614161646994171 - timing_per_token_ms/ref:0.06064243524193893 - perf/total_num_tokens:389658 - perf/time_per_step:304.4103294759989 - perf/throughput:320.0104942814715
[36m(TaskRunner pid=34683)[0m step:28 - actor/entropy:0.4299494599981699 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0008948520884359823 - actor/ppo_kl:-8.3550363553897e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0006566289812326431 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:5.66581582583936e-06 - actor/grad_norm:0.9271370768547058 - perf/mfu/actor:0.011226486625602931 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.12842178344727 - actor/lr:5e-07 - training/global_step:28 - training/epoch:0 - critic/score/mean:0.443359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.443359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06618847697973251 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06618847697973251 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:260.8583984375 - response_length/max:3072.0 - response_length/min:12.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:260.8583984375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:12.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:103.953125 - prompt_length/max:194.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010604783892631531 - timing_s/agent_loop/generate_sequences/min:1.4554235339164734 - timing_s/agent_loop/generate_sequences/max:243.58366216346622 - timing_s/agent_loop/generate_sequences/mean:21.008500415959134 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:243.58366216346622 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:151 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:251.85524939000607 - timing_s/reward:0.00036719441413879395 - timing_s/old_log_prob:28.113371964544058 - timing_s/ref:23.381805278360844 - timing_s/adv:0.07457751035690308 - timing_s/update_actor:92.62487874180079 - timing_s/step:396.59643452987075 - timing_s/stop_profile:0.00012967362999916077 - timing_per_token_ms/update_actor:0.24794716541289993 - timing_per_token_ms/adv:0.00019963623756087415 - timing_per_token_ms/gen:0.94285786256315 - timing_per_token_ms/ref:0.06259066051969485 - perf/total_num_tokens:373567 - perf/time_per_step:396.59643452987075 - perf/throughput:235.48308020143318
[36m(TaskRunner pid=34683)[0m step:29 - actor/entropy:0.4109516819298733 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006916009238011611 - actor/ppo_kl:-9.849611808832037e-06 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0006582131609320641 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.474811377910612e-06 - actor/grad_norm:0.8180207014083862 - perf/mfu/actor:0.01116520982658899 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.04996109008789 - actor/lr:5e-07 - training/global_step:29 - training/epoch:0 - critic/score/mean:0.3935546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3935546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0695749893784523 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0695749893784523 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:263.591796875 - response_length/max:3072.0 - response_length/min:36.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:263.591796875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:36.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:104.25 - prompt_length/max:189.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010875239968299866 - timing_s/agent_loop/generate_sequences/min:3.606899607926607 - timing_s/agent_loop/generate_sequences/max:268.41271613538265 - timing_s/agent_loop/generate_sequences/mean:21.318629188688647 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:268.41271613538265 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:89 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:276.7599840462208 - timing_s/reward:0.00033330172300338745 - timing_s/old_log_prob:28.21087422221899 - timing_s/ref:23.62961419671774 - timing_s/adv:0.07612109184265137 - timing_s/update_actor:93.74478736519814 - timing_s/step:423.07736444845796 - timing_s/stop_profile:0.00013420730829238892 - timing_per_token_ms/update_actor:0.24887776399818975 - timing_per_token_ms/adv:0.00020208960586893398 - timing_per_token_ms/gen:1.0253483800495735 - timing_per_token_ms/ref:0.06273293385912798 - perf/total_num_tokens:376670 - perf/time_per_step:423.07736444845796 - perf/throughput:222.57749507057852
[36m(TaskRunner pid=34683)[0m Training Progress:  52%|████████████████████████████████████████████████████▏                                                | 30/58 [3:27:42<3:55:16, 504.15s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  53%|█████████████████████████████████████████████████████▉                                               | 31/58 [3:31:36<3:10:25, 423.16s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  55%|███████████████████████████████████████████████████████▋                                             | 32/58 [3:38:41<3:03:37, 423.74s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 30}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:30 - actor/entropy:0.39781774920993485 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0007165670102153854 - actor/ppo_kl:-9.017271101008362e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.000711650587618351 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-2.4710013253326224e-06 - actor/grad_norm:0.9133403599262238 - perf/mfu/actor:0.010814875387608568 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.3008918762207 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.4761182714177407 - val-core/openai/gsm8k/acc/mean@1:0.4761182714177407 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:30 - training/epoch:0 - critic/score/mean:0.4677734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4677734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0702260285615921 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0702260285615921 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:254.466796875 - response_length/max:3072.0 - response_length/min:31.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:254.466796875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:31.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:103.7109375 - prompt_length/max:162.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00013899058103561401 - timing_s/agent_loop/generate_sequences/min:3.3687032014131546 - timing_s/agent_loop/generate_sequences/max:257.2987524867058 - timing_s/agent_loop/generate_sequences/mean:20.59100735039101 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:257.2987524867058 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:130 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:265.4482412934303 - timing_s/reward:0.0002857595682144165 - timing_s/old_log_prob:28.471922416239977 - timing_s/ref:23.614451315253973 - timing_s/adv:0.07987485826015472 - timing_s/update_actor:94.02385038882494 - timing_s/step:412.3341399617493 - timing_s/testing:287.7258070074022 - timing_s/stop_profile:0.00013542920351028442 - timing_per_token_ms/update_actor:0.2563536411763782 - timing_per_token_ms/adv:0.0002177767733267754 - timing_per_token_ms/gen:1.018705785279538 - timing_per_token_ms/ref:0.06438420202973485 - perf/total_num_tokens:366774 - perf/time_per_step:412.3341399617493 - perf/throughput:222.3766870444103
[36m(TaskRunner pid=34683)[0m step:31 - actor/entropy:0.3797869791451376 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0007826432436104369 - actor/ppo_kl:-7.686048887833863e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.000785117968916893 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.189619626293606e-05 - actor/grad_norm:0.8195363581180573 - perf/mfu/actor:0.010088575826143371 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.0334587097168 - actor/lr:5e-07 - training/global_step:31 - training/epoch:0 - critic/score/mean:0.48046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.48046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05200985446572304 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05200985446572304 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:234.681640625 - response_length/max:1404.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:234.681640625 - response_length_non_aborted/max:1404.0 - response_length_non_aborted/min:60.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:102.4140625 - prompt_length/max:195.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0001015588641166687 - timing_s/agent_loop/generate_sequences/min:5.891134329140186 - timing_s/agent_loop/generate_sequences/max:81.18720079213381 - timing_s/agent_loop/generate_sequences/mean:18.98802983902351 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:81.18720079213381 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:89 - timing_s/agent_loop/slowest/response_length:1404 - timing_s/gen:86.72260666638613 - timing_s/reward:0.0003421902656555176 - timing_s/old_log_prob:28.349442433565855 - timing_s/ref:23.72118939459324 - timing_s/adv:0.08278938755393028 - timing_s/update_actor:94.52710120007396 - timing_s/step:234.029934797436 - timing_s/stop_profile:0.00014261901378631592 - timing_per_token_ms/update_actor:0.2738439600681197 - timing_per_token_ms/adv:0.00023983993427870853 - timing_per_token_ms/gen:0.3608720535066044 - timing_per_token_ms/ref:0.06872002165381341 - perf/total_num_tokens:345186 - perf/time_per_step:234.029934797436 - perf/throughput:368.74128976147307
[36m(TaskRunner pid=34683)[0m Training Progress:  57%|█████████████████████████████████████████████████████████▍                                           | 33/58 [3:44:19<2:45:44, 397.79s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  59%|███████████████████████████████████████████████████████████▏                                         | 34/58 [3:50:50<2:38:19, 395.80s/it]
[36m(TaskRunner pid=34683)[0m step:32 - actor/entropy:0.34046476645744406 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0008247692957752406 - actor/ppo_kl:7.444284849267291e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0008157426491379738 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.485348553360467e-05 - actor/grad_norm:0.9193123877048492 - perf/mfu/actor:0.010541107985966965 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.22714138031006 - actor/lr:5e-07 - training/global_step:32 - training/epoch:0 - critic/score/mean:0.4990234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4990234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07021545618772507 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07021545618772507 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:244.265625 - response_length/max:3072.0 - response_length/min:60.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:244.265625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:60.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:103.8515625 - prompt_length/max:176.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010966137051582336 - timing_s/agent_loop/generate_sequences/min:5.807467017322779 - timing_s/agent_loop/generate_sequences/max:269.95656114444137 - timing_s/agent_loop/generate_sequences/mean:20.080484035021072 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:269.95656114444137 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:106 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:278.29607597738504 - timing_s/reward:0.00026713311672210693 - timing_s/old_log_prob:28.412492711097002 - timing_s/ref:23.645106371492147 - timing_s/adv:0.09788532927632332 - timing_s/update_actor:93.81592243537307 - timing_s/step:424.95842342078686 - timing_s/stop_profile:0.00013259053230285645 - timing_per_token_ms/update_actor:0.26317893813644005 - timing_per_token_ms/adv:0.00027459472069706265 - timing_per_token_ms/gen:1.112614645211192 - timing_per_token_ms/ref:0.06633089379107517 - perf/total_num_tokens:356472 - perf/time_per_step:424.95842342078686 - perf/throughput:209.7099271091676
[36m(TaskRunner pid=34683)[0m step:33 - actor/entropy:0.333521745793405 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006210286916257246 - actor/ppo_kl:-1.2495400275369661e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0009001558646559715 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-2.0420607040883e-06 - actor/grad_norm:0.7991610169410706 - perf/mfu/actor:0.009907646717538276 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.40252590179443 - actor/lr:5e-07 - training/global_step:33 - training/epoch:0 - critic/score/mean:0.4658203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4658203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.019905660301446915 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.019905660301446915 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:229.353515625 - response_length/max:3072.0 - response_length/min:41.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:229.353515625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:41.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:100.3125 - prompt_length/max:182.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00014286860823631287 - timing_s/agent_loop/generate_sequences/min:4.265845313668251 - timing_s/agent_loop/generate_sequences/max:181.2234508804977 - timing_s/agent_loop/generate_sequences/mean:18.544062089466024 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:181.2234508804977 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:89 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:189.96134878322482 - timing_s/reward:0.000432085245847702 - timing_s/old_log_prob:28.39144066721201 - timing_s/ref:23.7775318659842 - timing_s/adv:0.07864624261856079 - timing_s/update_actor:94.22962084040046 - timing_s/step:337.06592255085707 - timing_s/stop_profile:0.0001355186104774475 - timing_per_token_ms/update_actor:0.279134365510787 - timing_per_token_ms/adv:0.0002329720616229754 - timing_per_token_ms/gen:0.808834907830369 - timing_per_token_ms/ref:0.07043566780413475 - perf/total_num_tokens:337578 - perf/time_per_step:337.06592255085707 - perf/throughput:250.37980511739931
[36m(TaskRunner pid=34683)[0m step:34 - actor/entropy:0.34122400119667873 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0008828934380176179 - actor/ppo_kl:0.0001045307910327864 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0009468682110309601 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.8325518877234686e-05 - actor/grad_norm:0.847707986831665 - perf/mfu/actor:0.009759453915157461 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.23117446899414 - actor/lr:5e-07 - training/global_step:34 - training/epoch:0 - critic/score/mean:0.4814453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4814453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06377599388360977 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06377599388360977 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:220.912109375 - response_length/max:3072.0 - response_length/min:18.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:220.912109375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:18.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:103.171875 - prompt_length/max:189.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010652467608451843 - timing_s/agent_loop/generate_sequences/min:2.1543617472052574 - timing_s/agent_loop/generate_sequences/max:235.79451879113913 - timing_s/agent_loop/generate_sequences/mean:18.169734526971297 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:235.79451879113913 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:99 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:244.26482013985515 - timing_s/reward:0.0017164945602416992 - timing_s/old_log_prob:28.47098384797573 - timing_s/ref:23.743180811405182 - timing_s/adv:0.10190852731466293 - timing_s/update_actor:93.7842513769865 - timing_s/step:390.95901792123914 - timing_s/stop_profile:0.00015622004866600037 - timing_per_token_ms/update_actor:0.282600151198349 - timing_per_token_ms/adv:0.00030708103764415007 - timing_per_token_ms/gen:1.0797953271674394 - timing_per_token_ms/ref:0.07154534358078112 - perf/total_num_tokens:331862 - perf/time_per_step:390.95901792123914 - perf/throughput:212.2102220358909
[36m(TaskRunner pid=34683)[0m Training Progress:  60%|████████████████████████████████████████████████████████████▉                                        | 35/58 [3:59:50<2:48:21, 439.21s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  62%|██████████████████████████████████████████████████████████████▋                                      | 36/58 [4:06:34<2:37:10, 428.64s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  64%|████████████████████████████████████████████████████████████████▍                                    | 37/58 [4:13:11<2:26:42, 419.17s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 35}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:35 - actor/entropy:0.3352389926731121 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0007692753312085188 - actor/ppo_kl:0.00014185656090681675 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0010299719870090485 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.593846751468675e-06 - actor/grad_norm:0.8773908019065857 - perf/mfu/actor:0.009659308826454577 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.45520401000977 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.4836997725549659 - val-core/openai/gsm8k/acc/mean@1:0.4836997725549659 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:35 - training/epoch:0 - critic/score/mean:0.517578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.517578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02631077915430069 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.02631077915430069 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:215.302734375 - response_length/max:1903.0 - response_length/min:52.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:215.302734375 - response_length_non_aborted/max:1903.0 - response_length_non_aborted/min:52.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:105.8984375 - prompt_length/max:238.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00011005997657775879 - timing_s/agent_loop/generate_sequences/min:5.144221473485231 - timing_s/agent_loop/generate_sequences/max:97.23320848867297 - timing_s/agent_loop/generate_sequences/mean:17.48149645722151 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:97.23320848867297 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:136 - timing_s/agent_loop/slowest/response_length:1903 - timing_s/gen:105.4698349609971 - timing_s/reward:0.0003176257014274597 - timing_s/old_log_prob:28.52471072971821 - timing_s/ref:23.665285542607307 - timing_s/adv:0.10097643360495567 - timing_s/update_actor:93.85764246806502 - timing_s/step:252.33967035636306 - timing_s/testing:287.99359287694097 - timing_s/stop_profile:0.00013639405369758606 - timing_per_token_ms/update_actor:0.28535964995915303 - timing_per_token_ms/adv:0.00030700323372641656 - timing_per_token_ms/gen:0.4783863335646442 - timing_per_token_ms/ref:0.0719506416424168 - perf/total_num_tokens:328910 - perf/time_per_step:252.33967035636306 - perf/throughput:325.86037654672134
[36m(TaskRunner pid=34683)[0m step:36 - actor/entropy:0.3015824131871341 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0005798536659540332 - actor/ppo_kl:-0.00011700301796224721 - actor/pg_clipfrac_lower:5.201397925702622e-07 - actor/kl_loss:0.0010814955458045006 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:7.373676712951749e-05 - actor/grad_norm:0.8981126844882965 - perf/mfu/actor:0.0096065587447428 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.10628890991211 - actor/lr:5e-07 - training/global_step:36 - training/epoch:0 - critic/score/mean:0.5302734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5302734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06296546757221222 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06296546757221222 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:215.3095703125 - response_length/max:3072.0 - response_length/min:35.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:215.3095703125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:35.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:103.375 - prompt_length/max:166.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010472163558006287 - timing_s/agent_loop/generate_sequences/min:3.7398610934615135 - timing_s/agent_loop/generate_sequences/max:251.36244691163301 - timing_s/agent_loop/generate_sequences/mean:17.801734330074396 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:251.36244691163301 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:100 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:257.1991850808263 - timing_s/reward:0.00039388611912727356 - timing_s/old_log_prob:28.304649397730827 - timing_s/ref:23.652406610548496 - timing_s/adv:0.07949141040444374 - timing_s/update_actor:93.90905778110027 - timing_s/step:403.83625803515315 - timing_s/stop_profile:0.00015475228428840637 - timing_per_token_ms/update_actor:0.2877706446516297 - timing_per_token_ms/adv:0.00024358986190315947 - timing_per_token_ms/gen:1.166557895294413 - timing_per_token_ms/ref:0.07247935884678686 - perf/total_num_tokens:326333 - perf/time_per_step:403.83625803515315 - perf/throughput:202.02061696227963
[36m(TaskRunner pid=34683)[0m Training Progress:  66%|██████████████████████████████████████████████████████████████████▏                                  | 38/58 [4:20:09<2:19:31, 418.59s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  67%|███████████████████████████████████████████████████████████████████▉                                 | 39/58 [4:27:12<2:12:59, 419.95s/it]
[36m(TaskRunner pid=34683)[0m step:37 - actor/entropy:0.31451931595802307 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006871274093782631 - actor/ppo_kl:4.8245317876727256e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0010930262506008148 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.506020999759606e-05 - actor/grad_norm:0.8643545210361481 - perf/mfu/actor:0.009878035624528068 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.13812637329102 - actor/lr:5e-07 - training/global_step:37 - training/epoch:0 - critic/score/mean:0.529296875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.529296875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.055602747946977615 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.055602747946977615 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:223.689453125 - response_length/max:3072.0 - response_length/min:55.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:223.689453125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:55.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:103.609375 - prompt_length/max:232.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010415911674499512 - timing_s/agent_loop/generate_sequences/min:5.345938496291637 - timing_s/agent_loop/generate_sequences/max:242.2902779020369 - timing_s/agent_loop/generate_sequences/mean:18.301625454609166 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:242.2902779020369 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:110 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:250.58979127556086 - timing_s/reward:0.00037501007318496704 - timing_s/old_log_prob:28.351113855838776 - timing_s/ref:23.523653831332922 - timing_s/adv:0.08888110145926476 - timing_s/update_actor:93.80978100001812 - timing_s/step:396.93460500612855 - timing_s/stop_profile:0.00012939050793647766 - timing_per_token_ms/update_actor:0.27990052632526574 - timing_per_token_ms/adv:0.0002651948103238056 - timing_per_token_ms/gen:1.094001481177522 - timing_per_token_ms/ref:0.07018759684005836 - perf/total_num_tokens:335154 - perf/time_per_step:396.93460500612855 - perf/throughput:211.08892735292338
[36m(TaskRunner pid=34683)[0m step:38 - actor/entropy:0.3034421185438987 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006438341225134536 - actor/ppo_kl:5.010760130463865e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.001077648252248764 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.1380882953826443e-06 - actor/grad_norm:0.8547221124172211 - perf/mfu/actor:0.010359747921612966 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.20394897460938 - actor/lr:5e-07 - training/global_step:38 - training/epoch:0 - critic/score/mean:0.50390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.50390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.044445235282182693 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.044445235282182693 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:236.0244140625 - response_length/max:3072.0 - response_length/min:51.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:236.0244140625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:51.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:107.328125 - prompt_length/max:171.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00015220791101455688 - timing_s/agent_loop/generate_sequences/min:4.918169431388378 - timing_s/agent_loop/generate_sequences/max:262.00870744884014 - timing_s/agent_loop/generate_sequences/mean:19.282384220539825 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:262.00870744884014 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:99 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:270.1160197518766 - timing_s/reward:0.00026574358344078064 - timing_s/old_log_prob:28.34022107720375 - timing_s/ref:23.887516003102064 - timing_s/adv:0.08033986017107964 - timing_s/update_actor:94.10081921517849 - timing_s/step:417.10561279952526 - timing_s/stop_profile:0.00013012811541557312 - timing_per_token_ms/update_actor:0.2676413330617461 - timing_per_token_ms/adv:0.00022850244507450273 - timing_per_token_ms/gen:1.1176181777072047 - timing_per_token_ms/ref:0.06794081794319587 - perf/total_num_tokens:351593 - perf/time_per_step:417.10561279952526 - perf/throughput:210.7337981142124
[36m(TaskRunner pid=34683)[0m step:39 - actor/entropy:0.2968571437668288 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0007001533371067126 - actor/ppo_kl:2.5492313483255202e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0011525582522153854 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-1.6741430960642845e-05 - actor/grad_norm:0.9802435040473938 - perf/mfu/actor:0.00980239989750266 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.28382587432861 - actor/lr:5e-07 - training/global_step:39 - training/epoch:0 - critic/score/mean:0.5126953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5126953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.025497835129499435 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.025497835129499435 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:220.521484375 - response_length/max:3072.0 - response_length/min:50.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:220.521484375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:50.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:105.578125 - prompt_length/max:186.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010650977492332458 - timing_s/agent_loop/generate_sequences/min:5.004183728247881 - timing_s/agent_loop/generate_sequences/max:267.63146195188165 - timing_s/agent_loop/generate_sequences/mean:18.086042029346572 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:267.63146195188165 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:75 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:275.7788917571306 - timing_s/reward:0.0003608725965023041 - timing_s/old_log_prob:28.26670526713133 - timing_s/ref:23.83016136288643 - timing_s/adv:0.07371095940470695 - timing_s/update_actor:94.49182210490108 - timing_s/step:423.0079661048949 - timing_s/stop_profile:0.0001339539885520935 - timing_per_token_ms/update_actor:0.2829723414915313 - timing_per_token_ms/adv:0.00022074040177975647 - timing_per_token_ms/gen:1.221265695471187 - timing_per_token_ms/ref:0.07136359960855528 - perf/total_num_tokens:333926 - perf/time_per_step:423.0079661048949 - perf/throughput:197.3520753490935
[36m(TaskRunner pid=34683)[0m Training Progress:  69%|█████████████████████████████████████████████████████████████████████▋                               | 40/58 [4:38:49<2:30:58, 503.26s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  71%|███████████████████████████████████████████████████████████████████████▍                             | 41/58 [4:45:30<2:13:50, 472.38s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  72%|█████████████████████████████████████████████████████████████████████████▏                           | 42/58 [4:51:38<1:57:38, 441.15s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 40}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:40 - actor/entropy:0.2833044143335428 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0005456999768966853 - actor/ppo_kl:-8.806322924881371e-06 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0011071013286709785 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.153065447936143e-05 - actor/grad_norm:0.8518892824649811 - perf/mfu/actor:0.009893719145430788 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.16719436645508 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.4836997725549659 - val-core/openai/gsm8k/acc/mean@1:0.4836997725549659 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:40 - training/epoch:0 - critic/score/mean:0.498046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.498046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05826082453131676 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05826082453131676 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:225.8388671875 - response_length/max:3072.0 - response_length/min:40.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:225.8388671875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:40.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:104.4296875 - prompt_length/max:217.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010510161519050598 - timing_s/agent_loop/generate_sequences/min:4.2165676690638065 - timing_s/agent_loop/generate_sequences/max:255.67230401188135 - timing_s/agent_loop/generate_sequences/mean:18.640381621880806 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:255.67230401188135 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:82 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:263.8203879632056 - timing_s/reward:0.0004993416368961334 - timing_s/old_log_prob:28.29123068973422 - timing_s/ref:23.46766770258546 - timing_s/adv:0.07361778244376183 - timing_s/update_actor:94.50643223151565 - timing_s/step:410.78948068991303 - timing_s/testing:286.6543135493994 - timing_s/stop_profile:0.00014760717749595642 - timing_per_token_ms/update_actor:0.2794436116190826 - timing_per_token_ms/adv:0.00021767850631665704 - timing_per_token_ms/gen:1.140800522198944 - timing_per_token_ms/ref:0.0693909363017947 - perf/total_num_tokens:338195 - perf/time_per_step:410.78948068991303 - perf/throughput:205.82014383134154
[36m(TaskRunner pid=34683)[0m step:41 - actor/entropy:0.26123870981973596 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0007739218292499572 - actor/ppo_kl:-5.588272730072674e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0011751111596822739 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:8.759083339526796e-05 - actor/grad_norm:0.8386147320270538 - perf/mfu/actor:0.009303110020736706 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.59968948364258 - actor/lr:5e-07 - training/global_step:41 - training/epoch:0 - critic/score/mean:0.5791015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5791015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06123225763440132 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06123225763440132 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:209.03125 - response_length/max:3072.0 - response_length/min:52.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:209.03125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:52.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:101.2890625 - prompt_length/max:177.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00014255940914154053 - timing_s/agent_loop/generate_sequences/min:4.974211625754833 - timing_s/agent_loop/generate_sequences/max:246.8954286314547 - timing_s/agent_loop/generate_sequences/mean:17.297338451353426 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:246.8954286314547 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:106 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:252.5239100046456 - timing_s/reward:0.0003169625997543335 - timing_s/old_log_prob:29.003654528409243 - timing_s/ref:23.600870922207832 - timing_s/adv:0.09138096123933792 - timing_s/update_actor:94.28204022347927 - timing_s/step:400.1400868706405 - timing_s/stop_profile:0.0001246817409992218 - timing_per_token_ms/update_actor:0.2967008642263515 - timing_per_token_ms/adv:0.0002875713137865925 - timing_per_token_ms/gen:1.1797536534078599 - timing_per_token_ms/ref:0.07427076018418416 - perf/total_num_tokens:317768 - perf/time_per_step:400.1400868706405 - perf/throughput:198.53546946842755
[36m(TaskRunner pid=34683)[0m Training Progress:  74%|██████████████████████████████████████████████████████████████████████████▉                          | 43/58 [4:55:02<1:32:29, 369.99s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  76%|████████████████████████████████████████████████████████████████████████████▌                        | 44/58 [5:01:52<1:29:09, 382.09s/it]
[36m(TaskRunner pid=34683)[0m step:42 - actor/entropy:0.2768287577491719 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006112570683853846 - actor/ppo_kl:2.8697624914642006e-05 - actor/pg_clipfrac_lower:4.2275432861060835e-06 - actor/kl_loss:0.0011833477765321732 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.929696661528979e-05 - actor/grad_norm:0.9721859395503998 - perf/mfu/actor:0.009549479032608926 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.07052993774414 - actor/lr:5e-07 - training/global_step:42 - training/epoch:0 - critic/score/mean:0.54296875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.54296875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02333284355700016 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.02333284355700016 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:215.9560546875 - response_length/max:3072.0 - response_length/min:42.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:215.9560546875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:42.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:102.25 - prompt_length/max:190.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010174140334129333 - timing_s/agent_loop/generate_sequences/min:4.315578665584326 - timing_s/agent_loop/generate_sequences/max:212.5920604877174 - timing_s/agent_loop/generate_sequences/mean:17.66367756172258 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:212.5920604877174 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:99 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:221.62259884178638 - timing_s/reward:0.0002463012933731079 - timing_s/old_log_prob:28.05296043306589 - timing_s/ref:23.5565728507936 - timing_s/adv:0.0732508935034275 - timing_s/update_actor:94.21157364547253 - timing_s/step:368.1494343802333 - timing_s/stop_profile:0.00013416633009910583 - timing_per_token_ms/update_actor:0.2891318016513245 - timing_per_token_ms/adv:0.00022480425696862446 - timing_per_token_ms/gen:1.0021868546108392 - timing_per_token_ms/ref:0.07229424247503737 - perf/total_num_tokens:325843 - perf/time_per_step:368.1494343802333 - perf/throughput:221.27088185572342
[36m(TaskRunner pid=34683)[0m step:43 - actor/entropy:0.25514301999646705 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0008356927519344026 - actor/ppo_kl:-9.686617534754305e-06 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0011913105845451355 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.9319757786083755e-06 - actor/grad_norm:0.9291050136089325 - perf/mfu/actor:0.00944278419614279 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.35750961303711 - actor/lr:5e-07 - training/global_step:43 - training/epoch:0 - critic/score/mean:0.5146484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5146484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.010657994076609612 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.010657994076609612 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:209.7451171875 - response_length/max:785.0 - response_length/min:57.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:209.7451171875 - response_length_non_aborted/max:785.0 - response_length_non_aborted/min:57.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:106.234375 - prompt_length/max:184.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.754672646522522e-05 - timing_s/agent_loop/generate_sequences/min:5.559589400887489 - timing_s/agent_loop/generate_sequences/max:48.156861294060946 - timing_s/agent_loop/generate_sequences/mean:17.425519410160632 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:48.156861294060946 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:109 - timing_s/agent_loop/slowest/response_length:765 - timing_s/gen:56.38636277616024 - timing_s/reward:0.0003025531768798828 - timing_s/old_log_prob:28.32908034324646 - timing_s/ref:24.14257711544633 - timing_s/adv:0.07580510899424553 - timing_s/update_actor:94.25787129625678 - timing_s/step:203.76902898401022 - timing_s/stop_profile:0.00014293193817138672 - timing_per_token_ms/update_actor:0.291312267769358 - timing_per_token_ms/adv:0.0002342823777571772 - timing_per_token_ms/gen:0.26253201093291356 - timing_per_token_ms/ref:0.07461476471489735 - perf/total_num_tokens:323563 - perf/time_per_step:203.76902898401022 - perf/throughput:396.9727411634646
[36m(TaskRunner pid=34683)[0m step:44 - actor/entropy:0.2624310193787096 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006845694849744177 - actor/ppo_kl:0.0001003011983264912 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0011803675442934036 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.186726487514058e-05 - actor/grad_norm:0.8653887510299683 - perf/mfu/actor:0.00972948371442955 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.23353958129883 - actor/lr:5e-07 - training/global_step:44 - training/epoch:0 - critic/score/mean:0.5341796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5341796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.046764206141233444 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.046764206141233444 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:219.2294921875 - response_length/max:3072.0 - response_length/min:35.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:219.2294921875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:35.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:103.296875 - prompt_length/max:170.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.52109694480896e-05 - timing_s/agent_loop/generate_sequences/min:3.6322715617716312 - timing_s/agent_loop/generate_sequences/max:255.8865764848888 - timing_s/agent_loop/generate_sequences/mean:18.120327335971524 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:255.8865764848888 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:132 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:264.02556158974767 - timing_s/reward:0.0002705790102481842 - timing_s/old_log_prob:28.379741370677948 - timing_s/ref:23.452984996140003 - timing_s/adv:0.09010377153754234 - timing_s/update_actor:93.71124996989965 - timing_s/step:410.20187767222524 - timing_s/stop_profile:0.0001291707158088684 - timing_per_token_ms/update_actor:0.28374391013906824 - timing_per_token_ms/adv:0.00027282099494512727 - timing_per_token_ms/gen:1.176107557050161 - timing_per_token_ms/ref:0.07101219618108985 - perf/total_num_tokens:330267 - perf/time_per_step:410.20187767222524 - perf/throughput:201.283208327914
[36m(TaskRunner pid=34683)[0m Training Progress:  78%|██████████████████████████████████████████████████████████████████████████████▎                      | 45/58 [5:10:38<1:32:08, 425.30s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  79%|████████████████████████████████████████████████████████████████████████████████                     | 46/58 [5:14:06<1:11:59, 359.92s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  81%|█████████████████████████████████████████████████████████████████████████████████▊                   | 47/58 [5:20:57<1:08:50, 375.49s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 45}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:45 - actor/entropy:0.24831120031012688 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006521200506313107 - actor/ppo_kl:8.597169165014407e-06 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0012005530297756195 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.4423682903386137e-05 - actor/grad_norm:0.7864663600921631 - perf/mfu/actor:0.009696644017960658 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.1987190246582 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.5041698256254739 - val-core/openai/gsm8k/acc/mean@1:0.5041698256254739 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:45 - training/epoch:0 - critic/score/mean:0.552734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.552734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.045394301414489746 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.045394301414489746 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:219.908203125 - response_length/max:1586.0 - response_length/min:41.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:219.908203125 - response_length_non_aborted/max:1586.0 - response_length_non_aborted/min:41.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:104.4140625 - prompt_length/max:182.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.69618558883667e-05 - timing_s/agent_loop/generate_sequences/min:4.114201504737139 - timing_s/agent_loop/generate_sequences/max:84.00519877299666 - timing_s/agent_loop/generate_sequences/mean:17.997854452092724 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:84.00519877299666 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:84 - timing_s/agent_loop/slowest/response_length:1586 - timing_s/gen:92.16298051178455 - timing_s/reward:0.00030877813696861267 - timing_s/old_log_prob:28.267863173037767 - timing_s/ref:23.674809336662292 - timing_s/adv:0.07513107359409332 - timing_s/update_actor:94.37897071242332 - timing_s/step:239.11898425221443 - timing_s/testing:286.8307634219527 - timing_s/stop_profile:0.00013606995344161987 - timing_per_token_ms/update_actor:0.2841832749556567 - timing_per_token_ms/adv:0.00022622618559765053 - timing_per_token_ms/gen:0.40927491279113515 - timing_per_token_ms/ref:0.07128690639934929 - perf/total_num_tokens:332106 - perf/time_per_step:239.11898425221443 - perf/throughput:347.218353488933
[36m(TaskRunner pid=34683)[0m step:46 - actor/entropy:0.2250041278603021 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0008055985240389418 - actor/ppo_kl:6.616844292040014e-06 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0011668838560581207 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-2.2195233460031716e-05 - actor/grad_norm:0.8838712573051453 - perf/mfu/actor:0.009468267420877401 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.25617218017578 - actor/lr:5e-07 - training/global_step:46 - training/epoch:0 - critic/score/mean:0.5732421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5732421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.015194842591881752 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.015194842591881752 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:211.232421875 - response_length/max:895.0 - response_length/min:48.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:211.232421875 - response_length_non_aborted/max:895.0 - response_length_non_aborted/min:48.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:103.6328125 - prompt_length/max:194.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00014537200331687927 - timing_s/agent_loop/generate_sequences/min:4.744416426867247 - timing_s/agent_loop/generate_sequences/max:54.88028294593096 - timing_s/agent_loop/generate_sequences/mean:17.665475058376614 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:54.88028294593096 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:135 - timing_s/agent_loop/slowest/response_length:895 - timing_s/gen:60.71112623810768 - timing_s/reward:0.0017114914953708649 - timing_s/old_log_prob:28.479138888418674 - timing_s/ref:23.675656612962484 - timing_s/adv:0.10359594598412514 - timing_s/update_actor:93.59483166411519 - timing_s/step:207.20270160213113 - timing_s/stop_profile:0.0001497715711593628 - timing_per_token_ms/update_actor:0.29028674117806846 - timing_per_token_ms/adv:0.00032130545057137895 - timing_per_token_ms/gen:0.2806776000134427 - timing_per_token_ms/ref:0.07343064869321102 - perf/total_num_tokens:322422 - perf/time_per_step:207.20270160213113 - perf/throughput:389.0176111447523
[36m(TaskRunner pid=34683)[0m Training Progress:  83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 48/58 [5:27:52<1:04:31, 387.14s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  84%|███████████████████████████████████████████████████████████████████████████████████████                | 49/58 [5:34:40<59:02, 393.59s/it]
[36m(TaskRunner pid=34683)[0m step:47 - actor/entropy:0.22122157728881575 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0009544035521003025 - actor/ppo_kl:0.00010062287908052525 - actor/pg_clipfrac_lower:3.7273377984092804e-06 - actor/kl_loss:0.0013113003224134445 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.0326734273036209e-05 - actor/grad_norm:0.8963416516780853 - perf/mfu/actor:0.00930923581303348 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.25994110107422 - actor/lr:5e-07 - training/global_step:47 - training/epoch:0 - critic/score/mean:0.578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01953725330531597 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.01953725330531597 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:209.189453125 - response_length/max:3072.0 - response_length/min:46.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:209.189453125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:46.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:100.390625 - prompt_length/max:193.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0001082010567188263 - timing_s/agent_loop/generate_sequences/min:4.671140991151333 - timing_s/agent_loop/generate_sequences/max:256.2480214163661 - timing_s/agent_loop/generate_sequences/mean:17.34713044216187 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:256.2480214163661 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:193 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:264.5555142574012 - timing_s/reward:0.0002772994339466095 - timing_s/old_log_prob:28.656242322176695 - timing_s/ref:23.867559265345335 - timing_s/adv:0.07799503952264786 - timing_s/update_actor:93.95608040690422 - timing_s/step:411.67096995562315 - timing_s/stop_profile:0.00015980005264282227 - timing_per_token_ms/update_actor:0.29638207124981614 - timing_per_token_ms/adv:0.0002460333728357082 - timing_per_token_ms/gen:1.2350287767023072 - timing_per_token_ms/ref:0.07528960999761942 - perf/total_num_tokens:317010 - perf/time_per_step:411.67096995562315 - perf/throughput:192.51418191703723
[36m(TaskRunner pid=34683)[0m step:48 - actor/entropy:0.23258616465318482 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0005983092496535392 - actor/ppo_kl:0.00011284977986747435 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0012755077332258224 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:7.351590634252503e-06 - actor/grad_norm:0.7064109146595001 - perf/mfu/actor:0.009924746268014942 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.38230895996094 - actor/lr:5e-07 - training/global_step:48 - training/epoch:0 - critic/score/mean:0.56640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.56640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05098043382167816 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05098043382167816 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:227.9150390625 - response_length/max:3072.0 - response_length/min:51.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:227.9150390625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:51.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:102.4609375 - prompt_length/max:159.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.52593982219696e-05 - timing_s/agent_loop/generate_sequences/min:5.0053366497159 - timing_s/agent_loop/generate_sequences/max:258.651173774153 - timing_s/agent_loop/generate_sequences/mean:18.60056136662388 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:258.651173774153 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:99 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:267.1074762791395 - timing_s/reward:0.0002252832055091858 - timing_s/old_log_prob:28.29227403923869 - timing_s/ref:23.78202500194311 - timing_s/adv:0.09814612567424774 - timing_s/update_actor:94.31707258149981 - timing_s/step:414.16809029504657 - timing_s/stop_profile:0.000131119042634964 - timing_per_token_ms/update_actor:0.27879301985338617 - timing_per_token_ms/adv:0.00029011136599887006 - timing_per_token_ms/gen:1.1444929034819697 - timing_per_token_ms/ref:0.07029758650313507 - perf/total_num_tokens:338305 - perf/time_per_step:414.16809029504657 - perf/throughput:204.20754756782267
[36m(TaskRunner pid=34683)[0m step:49 - actor/entropy:0.2277835257409606 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0005800234541197824 - actor/ppo_kl:5.5081311264082444e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0012561306357383728 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:5.216946645347775e-05 - actor/grad_norm:0.8340444564819336 - perf/mfu/actor:0.010194196974733281 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.45426940917969 - actor/lr:5e-07 - training/global_step:49 - training/epoch:0 - critic/score/mean:0.580078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.580078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05751173570752144 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05751173570752144 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:231.359375 - response_length/max:3072.0 - response_length/min:67.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:231.359375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:67.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:105.578125 - prompt_length/max:212.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00014443323016166687 - timing_s/agent_loop/generate_sequences/min:6.430608108639717 - timing_s/agent_loop/generate_sequences/max:253.33374767005444 - timing_s/agent_loop/generate_sequences/mean:19.054327942314558 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:253.33374767005444 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:77 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:261.66520895436406 - timing_s/reward:0.00026097148656845093 - timing_s/old_log_prob:28.598339047282934 - timing_s/ref:23.622325647622347 - timing_s/adv:0.07869069650769234 - timing_s/update_actor:93.99000934138894 - timing_s/step:408.49485228955746 - timing_s/stop_profile:0.00012747198343276978 - timing_per_token_ms/update_actor:0.272415859016732 - timing_per_token_ms/adv:0.00022807310942917693 - timing_per_token_ms/gen:1.1044827149083376 - timing_per_token_ms/ref:0.06846574628901858 - perf/total_num_tokens:345024 - perf/time_per_step:408.49485228955746 - perf/throughput:211.15565965286217
[36m(TaskRunner pid=34683)[0m Training Progress:  86%|████████████████████████████████████████████████████████████████████████████████████████▊              | 50/58 [5:43:55<58:54, 441.76s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  88%|██████████████████████████████████████████████████████████████████████████████████████████▌            | 51/58 [5:50:40<50:15, 430.84s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  90%|████████████████████████████████████████████████████████████████████████████████████████████▎          | 52/58 [5:57:40<42:45, 427.61s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 50}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:50 - actor/entropy:0.2282887341134483 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0008250915684016036 - actor/ppo_kl:3.4862297821014465e-05 - actor/pg_clipfrac_lower:3.859930984617677e-06 - actor/kl_loss:0.0013030841946601868 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.0588357634208094e-05 - actor/grad_norm:0.8182504773139954 - perf/mfu/actor:0.009696685206413208 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.32122421264648 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.4965883244882487 - val-core/openai/gsm8k/acc/mean@1:0.4965883244882487 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:50 - training/epoch:0 - critic/score/mean:0.5478515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5478515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.047561440616846085 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.047561440616846085 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:220.5703125 - response_length/max:2119.0 - response_length/min:53.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:220.5703125 - response_length_non_aborted/max:2119.0 - response_length_non_aborted/min:53.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:102.46875 - prompt_length/max:171.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.375810623168945e-05 - timing_s/agent_loop/generate_sequences/min:5.3739170506596565 - timing_s/agent_loop/generate_sequences/max:114.39830182120204 - timing_s/agent_loop/generate_sequences/mean:18.31154509917178 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:114.39830182120204 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:90 - timing_s/agent_loop/slowest/response_length:2119 - timing_s/gen:122.44723615050316 - timing_s/reward:0.00032022595405578613 - timing_s/old_log_prob:28.53582739084959 - timing_s/ref:23.75256061926484 - timing_s/adv:0.07776829972863197 - timing_s/update_actor:93.98887472599745 - timing_s/step:269.3879019320011 - timing_s/testing:284.5871758945286 - timing_s/stop_profile:0.00013791397213935852 - timing_per_token_ms/update_actor:0.2841328530496428 - timing_per_token_ms/adv:0.00023509728085513548 - timing_per_token_ms/gen:0.5421281662881343 - timing_per_token_ms/ref:0.07180512412411678 - perf/total_num_tokens:330792 - perf/time_per_step:269.3879019320011 - perf/throughput:306.9848326777296
[36m(TaskRunner pid=34683)[0m step:51 - actor/entropy:0.21741740404831944 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0008153016588039463 - actor/ppo_kl:6.076765967844011e-05 - actor/pg_clipfrac_lower:4.822531082027126e-06 - actor/kl_loss:0.0013159308582544327 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-6.661795637086243e-05 - actor/grad_norm:0.8897998332977295 - perf/mfu/actor:0.009366558493867555 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.1784782409668 - actor/lr:5e-07 - training/global_step:51 - training/epoch:0 - critic/score/mean:0.6279296875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6279296875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04360164329409599 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04360164329409599 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:213.6455078125 - response_length/max:3072.0 - response_length/min:49.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:213.6455078125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:49.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:98.109375 - prompt_length/max:186.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.688735008239746e-05 - timing_s/agent_loop/generate_sequences/min:4.784734673798084 - timing_s/agent_loop/generate_sequences/max:252.96268505230546 - timing_s/agent_loop/generate_sequences/mean:17.611424123457255 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:252.96268505230546 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:80 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:258.5419299341738 - timing_s/reward:0.0002843588590621948 - timing_s/old_log_prob:28.27622751519084 - timing_s/ref:23.400857664644718 - timing_s/adv:0.08064966276288033 - timing_s/update_actor:94.2118236720562 - timing_s/step:405.22766215726733 - timing_s/stop_profile:0.00012505054473876953 - timing_per_token_ms/update_actor:0.2951156152703358 - timing_per_token_ms/adv:0.0002526325669107288 - timing_per_token_ms/gen:1.1817817095079093 - timing_per_token_ms/ref:0.07330246075688193 - perf/total_num_tokens:319237 - perf/time_per_step:405.22766215726733 - perf/throughput:196.94916574828085
[36m(TaskRunner pid=34683)[0m Training Progress:  91%|██████████████████████████████████████████████████████████████████████████████████████████████         | 53/58 [6:04:43<35:31, 426.28s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  93%|███████████████████████████████████████████████████████████████████████████████████████████████▉       | 54/58 [6:11:38<28:10, 422.69s/it]
[36m(TaskRunner pid=34683)[0m step:52 - actor/entropy:0.21199083507235628 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.000712307671221879 - actor/ppo_kl:3.470582573505965e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.001313788816332817 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.587202505090815e-05 - actor/grad_norm:0.8669069111347198 - perf/mfu/actor:0.009789220677592842 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.40330505371094 - actor/lr:5e-07 - training/global_step:52 - training/epoch:0 - critic/score/mean:0.6162109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6162109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05155644193291664 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05155644193291664 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:221.642578125 - response_length/max:3072.0 - response_length/min:45.0 - response_length/clip_ratio:0.0048828125 - response_length_non_aborted/mean:221.642578125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:45.0 - response_length_non_aborted/clip_ratio:0.0048828125 - response/aborted_ratio:0.0 - prompt_length/mean:100.921875 - prompt_length/max:165.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.537115693092346e-05 - timing_s/agent_loop/generate_sequences/min:4.63667244464159 - timing_s/agent_loop/generate_sequences/max:265.6815877817571 - timing_s/agent_loop/generate_sequences/mean:18.490366020949295 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:265.6815877817571 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:94 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:273.71436709165573 - timing_s/reward:0.0004671812057495117 - timing_s/old_log_prob:28.486738462001085 - timing_s/ref:23.406519666314125 - timing_s/adv:0.07335761561989784 - timing_s/update_actor:93.70696662738919 - timing_s/step:419.9453338049352 - timing_s/stop_profile:0.00012901052832603455 - timing_per_token_ms/update_actor:0.28369744003254316 - timing_per_token_ms/adv:0.00022208986703207886 - timing_per_token_ms/gen:1.2059920475306691 - timing_per_token_ms/ref:0.07086313801842571 - perf/total_num_tokens:330306 - perf/time_per_step:419.9453338049352 - perf/throughput:196.63630799707093
[36m(TaskRunner pid=34683)[0m step:53 - actor/entropy:0.19969677254994167 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.000780087830719367 - actor/ppo_kl:-7.758294531656773e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0013279588893055916 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:8.319223086483696e-05 - actor/grad_norm:0.8520916402339935 - perf/mfu/actor:0.009902956948812828 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.10341262817383 - actor/lr:5e-07 - training/global_step:53 - training/epoch:0 - critic/score/mean:0.625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08911263197660446 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.08911263197660446 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:225.8291015625 - response_length/max:3072.0 - response_length/min:49.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:225.8291015625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:49.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:102.1953125 - prompt_length/max:180.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.639933705329895e-05 - timing_s/agent_loop/generate_sequences/min:4.782349057495594 - timing_s/agent_loop/generate_sequences/max:268.5643571950495 - timing_s/agent_loop/generate_sequences/mean:18.478980015959678 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:268.5643571950495 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:102 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:276.5629953555763 - timing_s/reward:0.00022989138960838318 - timing_s/old_log_prob:28.17077749595046 - timing_s/ref:23.568336233496666 - timing_s/adv:0.07679606229066849 - timing_s/update_actor:94.13147772848606 - timing_s/step:423.0776778496802 - timing_s/stop_profile:0.00012467056512832642 - timing_per_token_ms/update_actor:0.2802391141584654 - timing_per_token_ms/adv:0.0002286297951177548 - timing_per_token_ms/gen:1.1959532597138853 - timing_per_token_ms/ref:0.07016536686393944 - perf/total_num_tokens:335897 - perf/time_per_step:423.0776778496802 - perf/throughput:198.48423681155808
[36m(TaskRunner pid=34683)[0m step:54 - actor/entropy:0.2237485805817414 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0008003140010259813 - actor/ppo_kl:2.2253813101613673e-05 - actor/pg_clipfrac_lower:2.4053263132373104e-06 - actor/kl_loss:0.0012245867401361465 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.225971715574815e-05 - actor/grad_norm:0.830253005027771 - perf/mfu/actor:0.010817086779052538 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.19697570800781 - actor/lr:5e-07 - training/global_step:54 - training/epoch:0 - critic/score/mean:0.57421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.57421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05623317137360573 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05623317137360573 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:251.3876953125 - response_length/max:3072.0 - response_length/min:64.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:251.3876953125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:64.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:105.5546875 - prompt_length/max:189.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00013893097639083862 - timing_s/agent_loop/generate_sequences/min:6.423094719648361 - timing_s/agent_loop/generate_sequences/max:259.44930152222514 - timing_s/agent_loop/generate_sequences/mean:20.608281991917465 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:259.44930152222514 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:138 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:267.41566460579634 - timing_s/reward:0.0002511851489543915 - timing_s/old_log_prob:28.334059484302998 - timing_s/ref:23.768600407987833 - timing_s/adv:0.07575725764036179 - timing_s/update_actor:93.94755353406072 - timing_s/step:414.08435732126236 - timing_s/stop_profile:0.00013767927885055542 - timing_per_token_ms/update_actor:0.2570321210532729 - timing_per_token_ms/adv:0.00020726509508756772 - timing_per_token_ms/gen:1.03882614318877 - timing_per_token_ms/ref:0.06502876921768776 - perf/total_num_tokens:365509 - perf/time_per_step:414.08435732126236 - perf/throughput:220.67303046926273
[36m(TaskRunner pid=34683)[0m Training Progress:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████▋     | 55/58 [6:20:22<22:39, 453.23s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████▍   | 56/58 [6:27:06<14:37, 438.56s/it]
[36m(TaskRunner pid=34683)[0m Training Progress:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 57/58 [6:33:13<06:56, 416.90s/it]
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 55}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:55 - actor/entropy:0.19803013525961433 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0007673942770907161 - actor/ppo_kl:3.1519365673027266e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0012651905417442322 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.438444758772306e-05 - actor/grad_norm:0.7879091501235962 - perf/mfu/actor:0.009757244719157992 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.38940048217773 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.5079605761940864 - val-core/openai/gsm8k/acc/mean@1:0.5079605761940864 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:55 - training/epoch:0 - critic/score/mean:0.552734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.552734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.031812507659196854 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.031812507659196854 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:223.7998046875 - response_length/max:1448.0 - response_length/min:56.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:223.7998046875 - response_length_non_aborted/max:1448.0 - response_length_non_aborted/min:56.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:101.0703125 - prompt_length/max:170.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010787323117256165 - timing_s/agent_loop/generate_sequences/min:5.400805067270994 - timing_s/agent_loop/generate_sequences/max:82.79912096261978 - timing_s/agent_loop/generate_sequences/mean:18.65185905999533 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:82.79912096261978 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:81 - timing_s/agent_loop/slowest/response_length:1448 - timing_s/gen:91.01185948774219 - timing_s/reward:0.0002324432134628296 - timing_s/old_log_prob:28.579170245677233 - timing_s/ref:23.757309656590223 - timing_s/adv:0.0846436619758606 - timing_s/update_actor:93.85980032011867 - timing_s/step:237.84725223109126 - timing_s/testing:286.47785449400544 - timing_s/stop_profile:0.0001382790505886078 - timing_per_token_ms/update_actor:0.2821434056282068 - timing_per_token_ms/adv:0.00025443961070938987 - timing_per_token_ms/gen:0.3971351501182182 - timing_per_token_ms/ref:0.07141468692894162 - perf/total_num_tokens:332667 - perf/time_per_step:237.84725223109126 - perf/throughput:349.66453982489395
[36m(TaskRunner pid=34683)[0m step:56 - actor/entropy:0.19689699974333053 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0007097320774391846 - actor/ppo_kl:5.935356064235009e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0013310424983501434 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.762272638125786e-05 - actor/grad_norm:0.7951616048812866 - perf/mfu/actor:0.009501972609222994 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.46434020996094 - actor/lr:5e-07 - training/global_step:56 - training/epoch:0 - critic/score/mean:0.62890625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62890625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02664254792034626 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.02664254792034626 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:215.5908203125 - response_length/max:3072.0 - response_length/min:62.0 - response_length/clip_ratio:0.0009765625 - response_length_non_aborted/mean:215.5908203125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:62.0 - response_length_non_aborted/clip_ratio:0.0009765625 - response/aborted_ratio:0.0 - prompt_length/mean:101.0703125 - prompt_length/max:183.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.510666131973267e-05 - timing_s/agent_loop/generate_sequences/min:5.874374624341726 - timing_s/agent_loop/generate_sequences/max:251.9371499121189 - timing_s/agent_loop/generate_sequences/mean:18.03651442695991 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:251.9371499121189 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:102 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:257.59880028292537 - timing_s/reward:0.00023359432816505432 - timing_s/old_log_prob:28.280949719250202 - timing_s/ref:23.699988074600697 - timing_s/adv:0.07649162411689758 - timing_s/update_actor:93.99180584773421 - timing_s/step:404.1953085921705 - timing_s/stop_profile:0.00015615299344062805 - timing_per_token_ms/update_actor:0.28986466410618056 - timing_per_token_ms/adv:0.00023589523290465885 - timing_per_token_ms/gen:1.1668461951981761 - timing_per_token_ms/ref:0.07308923390293837 - perf/total_num_tokens:324261 - perf/time_per_step:404.1953085921705 - perf/throughput:200.5596014519657
[36m(TaskRunner pid=34683)[0m Training Progress: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 58/58 [6:45:00<00:00, 504.04s/it]Training Progress: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 58/58 [6:45:00<00:00, 418.98s/it]
[36m(TaskRunner pid=34683)[0m step:57 - actor/entropy:0.2004670290480135 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0008076110416368465 - actor/ppo_kl:4.336528890114266e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0012881066650152206 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.612723585475706e-05 - actor/grad_norm:0.792506217956543 - perf/mfu/actor:0.010493391396743797 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.51569747924805 - actor/lr:5e-07 - training/global_step:57 - training/epoch:0 - critic/score/mean:0.5400390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5400390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.050570834428071976 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.050570834428071976 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:241.423828125 - response_length/max:3072.0 - response_length/min:66.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:241.423828125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:66.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:106.7890625 - prompt_length/max:177.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00014388561248779297 - timing_s/agent_loop/generate_sequences/min:6.421478763222694 - timing_s/agent_loop/generate_sequences/max:211.1824826709926 - timing_s/agent_loop/generate_sequences/mean:19.630602582357824 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:211.1824826709926 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:130 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:219.17681490629911 - timing_s/reward:0.0003023594617843628 - timing_s/old_log_prob:28.49270185828209 - timing_s/ref:23.654860980808735 - timing_s/adv:0.07550084963440895 - timing_s/update_actor:94.2543792873621 - timing_s/step:366.2185477092862 - timing_s/stop_profile:0.00012891367077827454 - timing_per_token_ms/update_actor:0.2643362573614216 - timing_per_token_ms/adv:0.00021174201316546246 - timing_per_token_ms/gen:0.8865730444639918 - timing_per_token_ms/ref:0.06634002013856671 - perf/total_num_tokens:356570 - perf/time_per_step:366.2185477092862 - perf/throughput:243.41339497300294
[36m(TaskRunner pid=34683)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 58}
[36m(TaskRunner pid=34683)[0m validation generation end
[36m(TaskRunner pid=34683)[0m step:58 - actor/entropy:0.20915831624006387 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0006435133302034046 - actor/ppo_kl:-4.660258576549836e-05 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.001321312040090561 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:-6.9956489590072835e-06 - actor/grad_norm:0.8591887652873993 - perf/mfu/actor:0.01008400142150431 - perf/max_memory_allocated_gb:66.87102556228638 - perf/max_memory_reserved_gb:76.6171875 - perf/cpu_memory_used_gb:86.28580093383789 - actor/lr:5e-07 - val-aux/openai/gsm8k/reward/mean@1:0.5056861258529188 - val-core/openai/gsm8k/acc/mean@1:0.5056861258529188 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:58 - training/epoch:0 - critic/score/mean:0.58203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.58203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07516291737556458 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07516291737556458 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:230.126953125 - response_length/max:3072.0 - response_length/min:55.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:230.126953125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:55.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:103.6875 - prompt_length/max:164.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.370222687721252e-05 - timing_s/agent_loop/generate_sequences/min:5.576098993420601 - timing_s/agent_loop/generate_sequences/max:264.96499533578753 - timing_s/agent_loop/generate_sequences/mean:19.009225117595633 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:264.96499533578753 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:82 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:273.14186154678464 - timing_s/reward:0.0002597197890281677 - timing_s/old_log_prob:28.13533677905798 - timing_s/ref:23.684859558939934 - timing_s/adv:0.0741591788828373 - timing_s/update_actor:93.84043436869979 - timing_s/step:419.41095304116607 - timing_s/testing:287.82925302535295 - timing_s/stop_profile:0.00013887137174606323 - timing_per_token_ms/update_actor:0.2745269065802478 - timing_per_token_ms/adv:0.00021695008244790418 - timing_per_token_ms/gen:1.1590997731669197 - timing_per_token_ms/ref:0.06928922773264741 - perf/total_num_tokens:341826 - perf/time_per_step:419.41095304116607 - perf/throughput:203.75362011972126
[36m(TaskRunner pid=34683)[0m ("Final validation metrics: {'val-aux/openai/gsm8k/reward/mean@1': "
[36m(TaskRunner pid=34683)[0m  "0.5056861258529188, 'val-core/openai/gsm8k/acc/mean@1': 0.5056861258529188, "
[36m(TaskRunner pid=34683)[0m  "'val-aux/num_turns/min': 2, 'val-aux/num_turns/max': 2, "
[36m(TaskRunner pid=34683)[0m  "'val-aux/num_turns/mean': 2.0}")
/home/ma-user/.conda/envs/test01/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 27780 is still running
  _warn("subprocess %s is still running" % self.pid,
/home/ma-user/.conda/envs/test01/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 28060 is still running
  _warn("subprocess %s is still running" % self.pid,
